


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introduction &#8212; imate Manual</title>
    
    <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    
    <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/toggleprompt.js"></script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Install" href="install.html" />
    <link rel="prev" title="imate" href="index.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="index.html">
<p class="title">imate</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Introduction
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="install.html">
  Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="quickstart.html">
  Quick Start
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="notes.html">
  Notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ameli/imate" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fixed-matrix">
   1. Fixed Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-parameter-affine-matrix-function">
   2. One-Parameter Affine Matrix Function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   Applications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advantages-of-imate-package">
   Advantages of imate Package
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-useful-packages">
   Other Useful Packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>This package computes the trace of inverse of two forms of matrices:</p>
<section id="fixed-matrix">
<h2>1. Fixed Matrix<a class="headerlink" href="#fixed-matrix" title="Permalink to this headline">¶</a></h2>
<p>For an invertible matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, this package computes <span class="math notranslate nohighlight">\(\mathrm{trace}(\mathbf{A}^{-1})\)</span> for both sparse and dense matrices.</p>
<dl class="simple">
<dt><strong>Computing Methods:</strong></dt><dd><p>The following methods are implemented:</p>
<ol class="arabic simple">
<li><p><strong>Cholesky Decomposition</strong>:  accurate, suitable for small matrices.</p></li>
<li><p><strong>Hutchinson’s Randomized Estimator</strong>: approximation, suitable for large matrices.</p></li>
<li><p><strong>Stochastic Lanczos Quadrature</strong>: approximation, suitable for large matrices.</p></li>
</ol>
</dd>
</dl>
</section>
<section id="one-parameter-affine-matrix-function">
<h2>2. One-Parameter Affine Matrix Function<a class="headerlink" href="#one-parameter-affine-matrix-function" title="Permalink to this headline">¶</a></h2>
<p>Consider the matrix function <span class="math notranslate nohighlight">\(t\mapsto\mathbf{A}+t\mathbf{B}\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> are symmetric and positive-definite matrices and <span class="math notranslate nohighlight">\(t\)</span> is a real parameter. This package can interpolate the function</p>
<div class="math notranslate nohighlight" id="equation-map">
<span class="eqno">(1)<a class="headerlink" href="#equation-map" title="Permalink to this equation">¶</a></span>\[t \mapsto \mathrm{trace}\left((\mathbf{A}+t\mathbf{B})^{-1}\right).\]</div>
<dl>
<dt><strong>Interpolation Methods</strong></dt><dd><p>Various interpolation methods of the above function are implemented in this package, namely</p>
<ol class="arabic simple">
<li><p><strong>Eigenvalues Method</strong></p></li>
<li><p><strong>Monomial Basis Functions</strong></p></li>
<li><p><strong>Root Monomial Basis Functions</strong></p></li>
<li><p><strong>Rational Polynomial Functions</strong></p></li>
<li><p><strong>Radial Basis Functions</strong></p></li>
</ol>
<p>These interpolation methods are described in <a class="reference internal" href="old/InterpolateTraceOfInverse.html#ameli-2020" id="id1"><span>[Ameli-2020]</span></a>.</p>
</dd>
</dl>
</section>
<section id="applications">
<h2>Applications<a class="headerlink" href="#applications" title="Permalink to this headline">¶</a></h2>
<p>The above function is featured in a wide range of applications in statistics and machine learning. Particular applications are in model selection and optimizing hyperparameters with gradient-based maximum likelihood methods. In such applications, computing the above function is often a computational challenge for large matrices. Often, this function is evaluated for a wide range of the parameter <span class="math notranslate nohighlight">\(t\)</span> while <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> remain fixed. As such, an interpolation scheme enables fast computation of the function.</p>
<p>A common example of such an application can be found in regularization techniques applied to inverse problems and supervised learning. For instance, in ridge regression by generalized cross-validation (see <a class="reference internal" href="#golub-1997" id="id2"><span>[Golub-1997]</span></a>), the optimal regularization parameter <span class="math notranslate nohighlight">\(t\)</span> is sought by minimizing a function that involves <a class="reference internal" href="#equation-map">(1)</a> (see <a class="reference internal" href="old/examples.html#example-three"><span class="std std-ref">Example 3</span></a>). Another common usage of <a class="reference internal" href="#equation-map">(1)</a>, for instance, is the mixed covariance functions of the form <span class="math notranslate nohighlight">\(\mathbf{A} + t \mathbf{I}\)</span> that appear frequently in Gaussian processes with additive noise <a class="reference internal" href="old/InterpolateTraceOfInverse.html#ameli-2020" id="id3"><span>[Ameli-2020]</span></a> (see <a class="reference internal" href="old/examples.html#example-one"><span class="std std-ref">Example 1</span></a>). In most of these applications, the log-determinant of the covariance matrix is ubiquitous, particularly in likelihood functions or related variants. Namely, if one aims to maximize the likelihood by its derivative with respect to the parameter, the expression</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial t} \log \det (\mathbf{A} + t \mathbf{I}) = \mathrm{trace} \left( (\mathbf{A} + t \mathbf{I})^{-1} \right),\]</div>
<p>frequently appears. Other examples of <a class="reference internal" href="#equation-map">(1)</a> are in the optimal design of experiment, probabilistic principal component analysis (see Sec. 12.2 of <a class="reference internal" href="#bishop-2006" id="id4"><span>[Bishop-2006]</span></a>), relevance vector machines <a class="reference internal" href="#tipping-2001" id="id5"><span>[Tipping-2001]</span></a> and <a class="reference internal" href="#bishop-2006" id="id6"><span>[Bishop-2006]</span></a>, kernel smoothing (see Sec. 2.6 of <a class="reference internal" href="#rasmussen-2006" id="id7"><span>[Rasmussen-2006]</span></a>, and Bayesian linear models (see Sec. 3.3 of <a class="reference internal" href="#bishop-2006" id="id8"><span>[Bishop-2006]</span></a>.</p>
</section>
<section id="advantages-of-imate-package">
<h2>Advantages of imate Package<a class="headerlink" href="#advantages-of-imate-package" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
<p><strong>Interpolation</strong></p>
<p>The greatest benefit that imate offers is its ability to interpolate the trace of the inverse of <em>affine matrix functions</em>, which is implemented in <code class="xref py py-mod docutils literal notranslate"><span class="pre">imate.InterpolateTraceOfInverse</span></code> module based.</p>
<p><strong>Speed</strong></p>
<p>In a table, compare single core performance between pure python and pure cython of logdet and traceinv, also 20 core on the cluster, to show the scalability.</p>
<p>Explain the pure cythonic code is free of gil, and explain what gil free code is. In this package, gil is completely released for all high-performance parts of the code (often not easy task). Without completely releasing gil-lock, a cython program cannot achieve a pure C++ performance.</p>
<p>If Interpolate() function can also be called within a n gil environment, create a tutorial page on how to call it within cython.</p>
</section>
<section id="other-useful-packages">
<h2>Other Useful Packages<a class="headerlink" href="#other-useful-packages" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
<p>imate does not replace many sophisticated computational packages in linear algebra and machine learning. Rather, some if its features were implemented on top of other packages.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="ameli-2020"><span class="brackets">Ameli-2020</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Ameli, S., and Shadden. S. C. (2020). Interpolating the Trace of the Inverse of Matrix <span class="math notranslate nohighlight">\(\mathbf{A} + t \mathbf{B}\)</span>. <a class="reference external" href="https://arxiv.org/abs/2009.07385">arXiv:2009.07385</a> [math.NA]</p>
</dd>
<dt class="label" id="golub-1997"><span class="brackets"><a class="fn-backref" href="#id2">Golub-1997</a></span></dt>
<dd><p>Golub, G. H. &amp; von Matt, U. (1997). Generalized cross-validation for large-scale problems. Journal of Computational and Graphical Statistics, 6(1), 1-34. <a class="reference external" href="https://www.jstor.org/stable/1390722">doi: 10.2307/1390722</a></p>
</dd>
<dt class="label" id="tipping-2001"><span class="brackets"><a class="fn-backref" href="#id5">Tipping-2001</a></span></dt>
<dd><p>Michael E. Tipping. (2001). Sparse bayesian learning and the relevance vector machine. J. Mach. Learn. Res. 1, 211-244. <a class="reference external" href="https://dl.acm.org/doi/10.1162/15324430152748236">doi: 10.1162/15324430152748236</a></p>
</dd>
<dt class="label" id="bishop-2006"><span class="brackets">Bishop-2006</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id6">2</a>,<a href="#id8">3</a>)</span></dt>
<dd><p>Bishop, C. M. (2006). Pattern Recognition and Machine Learning (Information Science and Statistics). Berlin, Heidelberg: Springer-Verlag, <a class="reference external" href="https://www.springer.com/gp/book/9780387310732">ISBN: 978-0-387-31073-2</a></p>
</dd>
<dt class="label" id="rasmussen-2006"><span class="brackets"><a class="fn-backref" href="#id7">Rasmussen-2006</a></span></dt>
<dd><p>Rasmussen, C. E. &amp; Williams, C. K. I. (2006). Gaussian Processes for Machine Learning. Adaptive Computation and Machine Learning. Cambridge, MA, USA: MIT Press. <a class="reference external" href="http://www.gaussianprocess.org/gpml/">ISBN 0-262-18253-X</a>.</p>
</dd>
</dl>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">imate</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="install.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Install</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Siavash Ameli.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>
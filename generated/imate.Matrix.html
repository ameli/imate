


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>imate.Matrix &#8212; imate Manual</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom-pydata.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/toggleprompt.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/custom-pydata.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/logo-imate.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="imate.Matrix.initialize" href="imate.Matrix.initialize.html" />
    <link rel="prev" title="imate.InterpolateSchatten(kind=’rpf’)" href="../api/imate.InterpolateSchatten.rpf.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>

    <!-- Adobe Embed API -->
    <script src="https://documentcloud.adobe.com/view-sdk/viewer.js"></script>

    <!-- My custom JS -->
    <script type="text/javascript" src="../_static/js/custom-pydata.js"></script>

    <!-- Syntax highlighting for BibTex code blocks -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-solarizedlight.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs-bibtex@2.0.1/prism-bibtex.min.js"></script>

    
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="None">

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="auto">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img src="../_static/images/icons/logo-imate-light.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/images/icons/logo-imate-dark.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/install.html">
  1. Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/docker.html">
  2. Docker
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/gpu.html">
  3. GPU
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../cite.html">
  Publications
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ameli/imate" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://pypi.org/project/imate/" rel="noopener" target="_blank" title="PyPI"><span><i class="fab fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://anaconda.org/s-ameli/imate" rel="noopener" target="_blank" title="Anaconda Cloud"><span><i class="fa fa-circle-notch"></i></span>
            <label class="sr-only">Anaconda Cloud</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://hub.docker.com/repository/docker/sameli/imate" rel="noopener" target="_blank" title="Docker Hub"><span><i class="fab fa-docker"></i></span>
            <label class="sr-only">Docker Hub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://mybinder.org/v2/gh/ameli/imate/HEAD?filepath=notebooks%2FInterpolateTraceOfInverse.ipynb" rel="noopener" target="_blank" title="Lanuch Jupyter on Binder"><span><i class="fa fa-chart-line"></i></span>
            <label class="sr-only">Lanuch Jupyter on Binder</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  logdet
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.logdet.html">
   imate.logdet
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.logdet.eigenvalue.html">
   imate.logdet(method=’eigenvalue’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.logdet.cholesky.html">
   imate.logdet(method=’cholesky’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.logdet.slq.html">
   imate.logdet(method=’slq’)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  traceinv
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.traceinv.html">
   imate.traceinv
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.traceinv.eigenvalue.html">
   imate.traceinv(method=’eigenvalue’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.traceinv.cholesky.html">
   imate.traceinv(method=’cholesky’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.traceinv.hutchinson.html">
   imate.traceinv(method=’hutchinson’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.traceinv.slq.html">
   imate.traceinv(method=’slq’)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  trace
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.trace.html">
   imate.trace
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.trace.exact.html">
   imate.trace(method=’exact’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.trace.eigenvalue.html">
   imate.trace(method=’eigenvalue’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.trace.slq.html">
   imate.trace(method=’slq’)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Schatten Norm
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.schatten.html">
   imate.schatten
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Interpolators
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.InterpolateLogdet.html">
   imate.InterpolateLogdet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.InterpolateTrace.html">
   imate.InterpolateTrace
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.InterpolateSchatten.html">
   imate.InterpolateSchatten
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.InterpolateSchatten.ext.html">
   imate.InterpolateSchatten(kind=’ext’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.InterpolateSchatten.eig.html">
   imate.InterpolateSchatten(kind=’eig’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.InterpolateSchatten.mbf.html">
   imate.InterpolateSchatten(kind=’mbf’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.InterpolateSchatten.imbf.html">
   imate.InterpolateSchatten(kind=’imbf’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.InterpolateSchatten.rbf.html">
   imate.InterpolateSchatten(kind=’rbf’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.InterpolateSchatten.crf.html">
   imate.InterpolateSchatten(kind=’crf’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.InterpolateSchatten.spl.html">
   imate.InterpolateSchatten(kind=’spl’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/imate.InterpolateSchatten.rpf.html">
   imate.InterpolateSchatten(kind=’rpf’)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Operators
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   imate.Matrix
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.initialize.html">
     imate.Matrix.initialize
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.get_num_rows.html">
     imate.Matrix.get_num_rows
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.get_num_columns.html">
     imate.Matrix.get_num_columns
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.is_sparse.html">
     imate.Matrix.is_sparse
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.get_nnz.html">
     imate.Matrix.get_nnz
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.get_density.html">
     imate.Matrix.get_density
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.get_data_type_name.html">
     imate.Matrix.get_data_type_name
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.get_num_parameters.html">
     imate.Matrix.get_num_parameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imate.Matrix.get_linear_operator.html">
     imate.Matrix.get_linear_operator
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.AffineMatrixFunction.html">
   imate.AffineMatrixFunction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Sample Matrices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.correlation_matrix.html">
   imate.correlation_matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.toeplitz.html">
   imate.toeplitz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.sample_matrices.toeplitz_logdet.html">
   imate.sample_matrices.toeplitz_logdet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.sample_matrices.toeplitz_trace.html">
   imate.sample_matrices.toeplitz_trace
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.sample_matrices.toeplitz_traceinv.html">
   imate.sample_matrices.toeplitz_traceinv
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.sample_matrices.toeplitz_schatten.html">
   imate.sample_matrices.toeplitz_schatten
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Device Inquiry
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.Timer.html">
   imate.Timer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.Memory.html">
   imate.Memory
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.info.html">
   imate.info
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.device.get_processor_name.html">
   imate.device.get_processor_name
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.device.get_gpu_name.html">
   imate.device.get_gpu_name
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.device.get_num_cpu_threads.html">
   imate.device.get_num_cpu_threads
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.device.get_num_gpu_devices.html">
   imate.device.get_num_gpu_devices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.device.get_nvidia_driver_version.html">
   imate.device.get_nvidia_driver_version
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.device.locate_cuda.html">
   imate.device.locate_cuda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.device.restrict_to_single_processor.html">
   imate.device.restrict_to_single_processor
  </a>
 </li>
</ul>

    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      

<nav id="bd-toc-nav">
    
</nav>
    </div>
    
    <div class="toc-item">
      

<div class="tocsection editthispage">
    <a href="https://github.com/https://github.com/ameli/imate/edit/main/docs/source/generated/imate.Matrix.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="imate-matrix">
<h1>imate.Matrix<a class="headerlink" href="#imate-matrix" title="Permalink to this headline">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="imate.Matrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">imate.</span></span><span class="sig-name descname"><span class="pre">Matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#imate.Matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Create a linear operator object from an input matrix.</p>
<p>The linear operator is a container for various matrix types with a unified
interface, establishes a fully automatic dynamic buffer to allocate,
deallocate, and transfer data between CPU and multiple GPU devices on
demand, as well as performs basic matrix-vector operations with
high performance on both CPU or GPU devices.</p>
<p>An instance of this class can be used as an input matrix to any function in
<a class="reference internal" href="../index.html#module-imate" title="imate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">imate</span></code></a> that accepts <code class="docutils literal notranslate"><span class="pre">slq</span></code> method.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>A</strong><span class="classifier">numpy.ndarray or scipy.sparse, (n, n)</span></dt><dd><p>The input matrix <cite>A</cite> can be dense or sparse (both <cite>CSR</cite> and <cite>CSC</cite>
formats are supported). Also, the matrix data type can be either
<cite>32-bit</cite>, <cite>64-bit</cite>, or <cite>128-bit</cite>. The input matrix can be stored
either in row-ordering (<cite>C</cite> style) or column-ordering (<cite>Fortran</cite>
style).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>128-bit</cite> data type is not supported on GPU.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="imate.AffineMatrixFunction.html#imate.AffineMatrixFunction" title="imate.AffineMatrixFunction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">imate.AffineMatrixFunction</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p><strong>Where to use this class:</strong></p>
<p>The instances of this class can be used just as a normal matrix in any
function in <a class="reference internal" href="../index.html#module-imate" title="imate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">imate</span></code></a> that accepts <code class="docutils literal notranslate"><span class="pre">slq</span></code> method. For instance, when
calling <a class="reference internal" href="imate.logdet.html#imate.logdet" title="imate.logdet"><code class="xref py py-func docutils literal notranslate"><span class="pre">imate.logdet()</span></code></a> function using <code class="docutils literal notranslate"><span class="pre">method=slq</span></code> argument, the
input matrix <cite>A</cite> can be an instance of this class.</p>
<p><strong>Why using this class:</strong></p>
<p>This class is a replacement to <cite>numpy</cite>’s dense matrices and <cite>scipy</cite>’s
sparse matrices. The purpose of creating a linear operator is three-fold:</p>
<ol class="arabic simple">
<li><p>A container to handle a variety of matrices and data types with a
unified interface.</p></li>
<li><p>A dynamic buffer for matrix data on either CPU or multi-GPU devices
with fully automatic allocation, deallocation, and data transfer between
CPU and GPU devices.</p></li>
<li><p>Performing basic linear algebraic operations on the matrix data with
high performance on CPU or GPU devices.</p></li>
</ol>
<p>Further details of each of the points are described below.</p>
<p><strong>1. Unified interface for matrix types:</strong></p>
<p>The linear operator encompasses the following matrix types all in one
interface:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>Dense</em> or <em>sparse</em> matrices with <cite>CSR</cite> or <cite>CSC</cite> sparse formats.</p></li>
<li><p><cite>32-bit</cite>, <cite>64-bit</cite>, and <cite>128-bit</cite> data types.</p></li>
<li><p>Row-ordering (<cite>C</cite> style) and column-ordering (<cite>Fortran</cite> style) storage.</p></li>
</ul>
</div></blockquote>
<p><strong>2. Unified interface for memory buffer between CPU and GPU:</strong></p>
<p>This class creates a dynamic buffer to automatically allocate, deallocate,
and transfer matrix data based on demand between CPU and multiple GPU
devices. These operations are performed <strong>in parallel for each GPU
device</strong>. Also, deallocation is performed by a <strong>smart garbage collector</strong>,
so the user should not be concerned about cleaning the data on the device
and the issue of memory leak. An instance of this class can be efficiently
reused between multiple function calls. This class uses a <strong>lazy evaluation
strategy</strong>, meaning that data allocation and transfer are not performed
until a caller function requests matrix data from this class.</p>
<p><strong>3. Unified interface for basic algebraic operations:</strong></p>
<p>This class handles the following internal operations:</p>
<ol class="arabic simple">
<li><p>Matrix vector product
<span class="math notranslate nohighlight">\(\boldsymbol{y} = \mathbf{A} \boldsymbol{x}\)</span>.</p></li>
<li><p>Transposed matrix vector product
<span class="math notranslate nohighlight">\(\boldsymbol{y} = \mathbf{A}^{\intercal} \boldsymbol{x}\)</span>.</p></li>
<li><p>Additive matrix vector product
<span class="math notranslate nohighlight">\(\boldsymbol{y} = \boldsymbol{y} + \mathbf{A} \boldsymbol{x}\)</span>.</p></li>
<li><p>Additive transposed matrix vector product
<span class="math notranslate nohighlight">\(\boldsymbol{y} = \boldsymbol{y} + \mathbf{A}^{\intercal}
\boldsymbol{x}\)</span>.</p></li>
</ol>
<p>All the above operations are handled internally when an instance of this
class is called by other functions.</p>
<p>Each of the above operations has various internal implementations depending
on whether the matrix format is dense, sparse CSR, or sparse CSC,
whether the memory storage is C style or Fortran style, whether the data
type of 32-bit, 64-bit, or 128-bit, and whether the operation is performed
on CPU or multi-GPU devices. This class unifies all these implementations
in one interface.</p>
<p class="rubric">Examples</p>
<p><strong>Create Matrix object:</strong></p>
<p>Create a very large sparse matrix with 64-bit data type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a random sparse matrix with the size of ten million</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">imate</span> <span class="kn">import</span> <span class="n">toeplitz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">toeplitz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">gram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">dtype(&#39;float64&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="go">scipy.sparse.csr.csr_matrix</span>
</pre></div>
</div>
<p>Create a linear operator from the matrix <cite>A</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Import matrix operator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">imate</span> <span class="kn">import</span> <span class="n">Matrix</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a matrix operator object from matrix A</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">Aop</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Operation on CPU:</strong></p>
<p>Pass the above linear operator as input to any of the matrix functions in
<a class="reference internal" href="../index.html#module-imate" title="imate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">imate</span></code></a> that accepts <code class="docutils literal notranslate"><span class="pre">slq</span></code> method, such as
<a class="reference internal" href="imate.logdet.html#imate.logdet" title="imate.logdet"><code class="xref py py-func docutils literal notranslate"><span class="pre">imate.logdet()</span></code></a> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute log-determinant of Aop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">imate</span> <span class="kn">import</span> <span class="n">logdet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logdet</span><span class="p">(</span><span class="n">Aop</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;slq&#39;</span><span class="p">)</span>
<span class="go">13861581.003237441</span>
</pre></div>
</div>
<p>Note that the above function could also be called directly on the scipy
object <cite>A</cite> rather than <cite>Aop</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute log-determinant of Aop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logdet</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;slq&#39;</span><span class="p">)</span>
<span class="go">13861581.003237441</span>
</pre></div>
</div>
<p>However, with the above approach, the <a class="reference internal" href="imate.logdet.html#imate.logdet" title="imate.logdet"><code class="xref py py-func docutils literal notranslate"><span class="pre">logdet()</span></code></a> function still creates
an object of <a class="reference internal" href="#imate.Matrix" title="imate.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">imate.Matrix</span></code></a> internally. The advantage of using <cite>Aop</cite>
instead of <cite>A</cite> is more clear when using GPU.</p>
<p><strong>Operation on GPU:</strong></p>
<p>Reuse the same object <cite>Aop</cite> as created in the previous example. However,
this time by calling <a class="reference internal" href="imate.logdet.html#imate.logdet" title="imate.logdet"><code class="xref py py-func docutils literal notranslate"><span class="pre">imate.logdet()</span></code></a> function with <code class="docutils literal notranslate"><span class="pre">gpu=True</span></code>
argument, the data is automatically transferred from CPU to each of the
multi-GPU devices (then, it will be available on both CPU and GPU devices).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute log-determinant of Aop on GPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logdet</span><span class="p">(</span><span class="n">Aop</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;slq&#39;</span><span class="p">,</span> <span class="n">gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">13861581.003237441</span>
</pre></div>
</div>
<p><strong>Why using imate.Matrix object:</strong></p>
<p>An advantage of using <cite>Aop</cite> (instead of the matrix <cite>A</cite> directly) is that
by calling the above <cite>logdet</cite> function (or another function) again on this
matrix, the data of this matrix does not have to be re-allocated on the GPU
device again. The next example highlights this point. Call a second
function, for instance, <cite>traceinv</cite>, on the same object <cite>Aop</cite> as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute trace of inverse of Aop on GPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">imate</span> <span class="kn">import</span> <span class="n">traceinv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traceinv</span><span class="p">(</span><span class="n">Aop</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;slq&#39;</span><span class="p">,</span> <span class="n">gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">13861581.003237441</span>
</pre></div>
</div>
<p>In the above, no data is needed to be transferred from CPU host to GPU
device again. However, if <cite>A</cite> was used instead of <cite>Aop</cite>, the data would
have been transferred from CPU to GPU again for the second time. The <cite>Aop</cite>
object holds the data on GPU for later use as long as this object does not
go out of the scope of the python environment. Once the variable <cite>Aop</cite> goes
out of scope, the matrix data on all the GPU devices will be cleaned
automatically.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>A</strong><span class="classifier">numpy.ndarray or scipy.sparse</span></dt><dd><p>Input matrix <cite>A</cite> from python object.</p>
</dd>
<dt><strong>cpu_Aop</strong><span class="classifier">object</span></dt><dd><p>Matrix object on CPU.</p>
</dd>
<dt><strong>gpu_Aop</strong><span class="classifier">object</span></dt><dd><p>Matrix object on GPU.</p>
</dd>
<dt><strong>gpu</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <cite>True</cite>, the matrix object is created for GPU devices.</p>
</dd>
<dt><strong>num_gpu_devices</strong><span class="classifier">int, default=0</span></dt><dd><p>Number of GPU devices to be used. If <cite>0</cite>, it uses maximum number of
GPU devices that are available.</p>
</dd>
<dt><strong>initialized_on_cpu</strong><span class="classifier">bool, default=False</span></dt><dd><p>Indicates whether the matrix data is allocated in CPU.</p>
</dd>
<dt><strong>initialized_on_gpu</strong><span class="classifier">bool, default=False</span></dt><dd><p>Indicates whether the matrix data is allocated in GPU.</p>
</dd>
<dt><strong>data_type_name</strong><span class="classifier">str, default=None</span></dt><dd><p>The type of matrix data, and can be <cite>float32</cite>, <cite>float64</cite>, or
<cite>float128</cite>.</p>
</dd>
<dt><strong>num_parameters</strong><span class="classifier">int, default=0</span></dt><dd><p>Number of parameters of the linear operator. For <a class="reference internal" href="#imate.Matrix" title="imate.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> class,
this parameter is always <cite>0</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="imate.Matrix.initialize.html#imate.Matrix.initialize" title="imate.Matrix.initialize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize</span></code></a>(gpu, num_gpu_devices)</p></td>
<td><p>Initializes the object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="imate.Matrix.get_num_rows.html#imate.Matrix.get_num_rows" title="imate.Matrix.get_num_rows"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_num_rows</span></code></a>()</p></td>
<td><p>Returns the number of rows of the matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="imate.Matrix.get_num_columns.html#imate.Matrix.get_num_columns" title="imate.Matrix.get_num_columns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_num_columns</span></code></a>()</p></td>
<td><p>Returns the number of columns of the matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="imate.Matrix.is_sparse.html#imate.Matrix.is_sparse" title="imate.Matrix.is_sparse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_sparse</span></code></a>()</p></td>
<td><p>Determines whether the matrix is dense or sparse.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="imate.Matrix.get_nnz.html#imate.Matrix.get_nnz" title="imate.Matrix.get_nnz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_nnz</span></code></a>()</p></td>
<td><p>Returns the number of non-zero elements of the matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="imate.Matrix.get_density.html#imate.Matrix.get_density" title="imate.Matrix.get_density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_density</span></code></a>()</p></td>
<td><p>Returns the density of non-zero elements of the matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="imate.Matrix.get_data_type_name.html#imate.Matrix.get_data_type_name" title="imate.Matrix.get_data_type_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_type_name</span></code></a>()</p></td>
<td><p>Returns the data type name, which can be <cite>float32</cite>, <cite>float64</cite>, or <cite>float128</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="imate.Matrix.get_num_parameters.html#imate.Matrix.get_num_parameters" title="imate.Matrix.get_num_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_num_parameters</span></code></a>()</p></td>
<td><p>Returns the number of parameters of the linear operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="imate.Matrix.get_linear_operator.html#imate.Matrix.get_linear_operator" title="imate.Matrix.get_linear_operator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_linear_operator</span></code></a>([gpu, num_gpu_devices])</p></td>
<td><p>Sets the linear operator object on CPU or GPU and returns its object.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="../api/imate.InterpolateSchatten.rpf.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">imate.InterpolateSchatten(kind=’rpf’)</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="imate.Matrix.initialize.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">imate.Matrix.initialize</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, Siavash Ameli.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>
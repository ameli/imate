


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Generate Matirx (imate.generate_matrix) &#8212; imate Manual</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/toggleprompt.js"></script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">imate</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../introduction.html">
  Introduction
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../install.html">
  Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../quickstart.html">
  Quick Start
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../notes.html">
  Notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ameli/imate" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parameters">
   Parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mathematical-details">
   Mathematical Details
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-set-of-points">
     Generate Set of Points
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-function">
     Correlation Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sparse-matrix">
     Sparse Matrix
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example">
   Example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api">
   API
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="generate-matirx-imate-generate-matrix">
<span id="generate-matrix-userguide"></span><h1>Generate Matirx (<code class="xref py py-mod docutils literal notranslate"><span class="pre">imate.generate_matrix</span></code>)<a class="headerlink" href="#generate-matirx-imate-generate-matrix" title="Permalink to this headline">¶</a></h1>
<p>The sub package <code class="xref py py-mod docutils literal notranslate"><span class="pre">imate.generate_matrix</span></code> is tangent to the purpose of the imate package as it does not provide a computational utility. Rather, it generates sample matrices for test purposes only. imate works with generic invertible matrices. However, in most applications where imate can be utilized, the matrices are of the form of covariance or correlation matrices (such as in machine learning purposes). Such matrices have these characteristics:</p>
<ol class="arabic simple">
<li><p>symmetric</p></li>
<li><p>positive-definite or positive-semidefinite</p></li>
</ol>
<p>This sub-package generates such matrices to tests imate on applicable matrices.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">imate</span> <span class="kn">import</span> <span class="n">generate_matrix</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate a symmetric positive-definite matrix of the shape (20**2,20**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">generate_matrix</span><span class="p">(</span><span class="n">NumPoints</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">K</span></code> in the above has the shape <code class="docutils literal notranslate"><span class="pre">(20**2,20**2)</span></code>, is symmetric and positive-definite.</p>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">imate.generate_matrix</span></code> module accepts the following attributes as input argument to customize the generated matrix.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="NumPoints">
<span class="sig-name descname"><span class="pre">NumPoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">20</span></em><a class="headerlink" href="#NumPoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the size of the matrix.</p>
<ul class="simple">
<li><p>When the parameter <a class="reference internal" href="#GridOfPoints" title="GridOfPoints"><code class="xref py py-data docutils literal notranslate"><span class="pre">GridOfPoints</span></code></a> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the matrix has the shape of <code class="docutils literal notranslate"><span class="pre">(NumPoints**2,NumPoints**2)</span></code>.
This is corresponding to the mutual correlation between a set of <span class="math notranslate nohighlight">\(n^2\)</span> points generated on an equidistanced rectangular
grid of <span class="math notranslate nohighlight">\(n \times n\)</span> points in the unit square.</p></li>
<li><p>When the parameter <a class="reference internal" href="#GridOfPoints" title="GridOfPoints"><code class="xref py py-data docutils literal notranslate"><span class="pre">GridOfPoints</span></code></a> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, the matrix has the shape of <code class="docutils literal notranslate"><span class="pre">(NumPoints,NumPoints)</span></code>.
This is corresponding to the mutual corelation between a set of <span class="math notranslate nohighlight">\(n\)</span> points generated randomly in the unit square.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="GridOfPoints">
<span class="sig-name descname"><span class="pre">GridOfPoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#GridOfPoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the structure of the points which the correlation matrix if formed based on.</p>
<ul class="simple">
<li><p>When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the set of <span class="math notranslate nohighlight">\(n \times n\)</span> points is generated on an equispaced rectangular grid in the unit square.
Here, <span class="math notranslate nohighlight">\(n\)</span> is set by <a class="reference internal" href="#NumPoints" title="NumPoints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NumPoints</span></code></a> argument. As a result, the generated matrix is of the shape <span class="math notranslate nohighlight">\((n^2 \times n^2)\)</span>.</p></li>
<li><p>When set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, the set of <span class="math notranslate nohighlight">\(n \times n\)</span> points is generated randomly in the unit square.
Here, <span class="math notranslate nohighlight">\(n\)</span> is set by <a class="reference internal" href="#NumPoints" title="NumPoints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NumPoints</span></code></a> argument. As a result, the generated matrix is of the shape <span class="math notranslate nohighlight">\((n \times n)\)</span>.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DecorrelationScale">
<span class="sig-name descname"><span class="pre">DecorrelationScale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#DecorrelationScale" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorrelation scale parameter <span class="math notranslate nohighlight">\(\rho\)</span> of the <span class="xref std std-ref">Correlation Function</span>.
Generally, <span class="math notranslate nohighlight">\(\rho &gt; 0\)</span>, but in this class it should be set to <span class="math notranslate nohighlight">\(\rho \in (0,1]\)</span>.
Smaller <span class="math notranslate nohighlight">\(\rho\)</span> yields correlation matrix closer to the identity matrix, whereas
larget <span class="math notranslate nohighlight">\(\rho\)</span> leads to a more correlated matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nu">
<span class="sig-name descname"><span class="pre">nu</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#nu" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the smoothness of the stochastic process that is represented by the correlation matrix. (see the parameter <span class="math notranslate nohighlight">\(\nu\)</span> in <span class="xref std std-ref">Correlation Function</span>).
<span class="math notranslate nohighlight">\(\nu\)</span> should be positive. Small values of <span class="math notranslate nohighlight">\(\nu\)</span> yields correlation matrix closer to the identity matrix.
For values <span class="math notranslate nohighlight">\(\nu &gt; 100\)</span>, the Gaussian correlation function is used which corresponds to <span class="math notranslate nohighlight">\(\nu \to \infty\)</span>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="UseSparse">
<span class="sig-name descname"><span class="pre">UseSparse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#UseSparse" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines to generate dense or sparse matrix. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the sparse denisity of the matrix can be set by <a class="reference internal" href="#KernelThreshold" title="KernelThreshold"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelThreshold</span></code></a> argument.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="KernelThreshold">
<span class="sig-name descname"><span class="pre">KernelThreshold</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.03</span></em><a class="headerlink" href="#KernelThreshold" title="Permalink to this definition">¶</a></dt>
<dd><p>To sparsify the matrix, the matrix elements smaller than this threshold are considered to be zero
(see parameter <span class="math notranslate nohighlight">\(\kappa\)</span> in <span class="xref std std-ref">Sparse Matrix</span>).
Increasing the threshold yields a more sparse matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="RunInParallel">
<span class="sig-name descname"><span class="pre">RunInParallel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#RunInParallel" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, it eneables parallel processing of the rows and columns of thec correlation matrix using <code class="docutils literal notranslate"><span class="pre">ray</span></code> package.
This option is particularly useful for sparse large matrices.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Plot">
<span class="sig-name descname"><span class="pre">Plot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#Plot" title="Permalink to this definition">¶</a></dt>
<dd><p>If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, it plots the generated matrix.</p>
<ul class="simple">
<li><p>If no graphical backend exists (such as running the code on a remote server or manually disabling the X11 backend), the plot will not be shown, rather, it will ve saved as an <code class="docutils literal notranslate"><span class="pre">svg</span></code> file in the current directory.</p></li>
<li><p>If the executable <code class="docutils literal notranslate"><span class="pre">latex</span></code> is on the path, the plot is rendered using <span class="math notranslate nohighlight">\(\rm\LaTeX\)</span>, which then, it takes a bit longer to produce the plot.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\rm\LaTeX\)</span> is not installed, it uses any available San-Serif font to render the plot.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To manually disable interactive plot display, and save the plot as <code class="docutils literal notranslate"><span class="pre">SVG</span></code> instead, add the following in the
very begining of your code before importing <code class="docutils literal notranslate"><span class="pre">imate</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;IMATE_NO_DISPLAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;True&#39;</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Verbose:</span></span></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prints some information during the process.</p>
</dd></dl>

</section>
<section id="mathematical-details">
<h2>Mathematical Details<a class="headerlink" href="#mathematical-details" title="Permalink to this headline">¶</a></h2>
<p>The module <code class="xref py py-class docutils literal notranslate"><span class="pre">generate_matrix</span></code> produces a correlation matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> as follows.</p>
<ol class="arabic">
<li><p>It generates a set of spatial points <span class="math notranslate nohighlight">\(\boldsymbol{x}_i \in \mathcal{D}\)</span> (see <span class="xref std std-ref">Generate Set of Points</span>).</p></li>
<li><p>Using a given correlation function <span class="math notranslate nohighlight">\(K: \mathcal{D} \times \mathcal{D} \to [0,1]\)</span> (see <span class="xref std std-ref">Correlation Function</span>), the component <span class="math notranslate nohighlight">\(K_{ij}\)</span> of the matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is then computed by</p>
<div class="math notranslate nohighlight">
\[K_{ij} = K(\boldsymbol{x}_i,\boldsymbol{x}_j)\]</div>
</li>
</ol>
<section id="generate-set-of-points">
<h3>Generate Set of Points<a class="headerlink" href="#generate-set-of-points" title="Permalink to this headline">¶</a></h3>
<p>In this module, the set of points is defined in two ways:</p>
<p><strong>On a Grid:</strong> When <a class="reference internal" href="#GridOfPoints" title="GridOfPoints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GridOfPoints</span></code></a> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, a set of <span class="math notranslate nohighlight">\(n \times n\)</span> points are generated on a equi-distanced grid in the unit square <span class="math notranslate nohighlight">\(\mathcal{D} = [0,1]^2\)</span>.</p>
<p><strong>Random:</strong> When <a class="reference internal" href="#GridOfPoints" title="GridOfPoints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GridOfPoints</span></code></a> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, a set of <span class="math notranslate nohighlight">\(n\)</span> points are generated with uniform random distribution in the unit square <span class="math notranslate nohighlight">\(\mathcal{D} = [0,1]^2\)</span>.</p>
</section>
<section id="correlation-function">
<h3>Correlation Function<a class="headerlink" href="#correlation-function" title="Permalink to this headline">¶</a></h3>
<p>The module uses the Matern correlation function (see <a class="reference internal" href="#matern-1960" id="id1"><span>[Matern-1960]</span></a>, or <a class="reference internal" href="#stein-1999" id="id2"><span>[Stein-1999]</span></a>) defined by</p>
<div class="math notranslate nohighlight">
\[K(\boldsymbol{x},\boldsymbol{x}'|\rho,\nu) =
\frac{2^{1-\nu}}{\Gamma(\nu)}
\left( \sqrt{2 \nu} \frac{\| \boldsymbol{x} - \boldsymbol{x}' \|}{\rho} \right)
K_{\nu}\left(\sqrt{2 \nu}  \frac{\|\boldsymbol{x} - \boldsymbol{x}' \|}{\rho} \right)\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Gamma( \cdot)\)</span> is the Gamma function (see <a class="reference internal" href="#dlmf" id="id3"><span>[DLMF]</span></a>),</p></li>
<li><p><span class="math notranslate nohighlight">\(\| \cdot \|\)</span> is the Euclidean distance,</p></li>
<li><p><span class="math notranslate nohighlight">\(K_{\nu}(\cdot)\)</span> is the modified Bessel function of the second kind of order <span class="math notranslate nohighlight">\(\nu\)</span> (see <a class="reference internal" href="#dlmf" id="id4"><span>[DLMF]</span></a>).</p></li>
</ul>
</div></blockquote>
<p>and with the hyperparameters</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho &gt; 0\)</span>: <strong>decorrelation scale</strong> of the correlation function (see <a class="reference internal" href="#DecorrelationScale" title="DecorrelationScale"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DecorrelationScale</span></code></a>).</p></li>
<li><p><span class="math notranslate nohighlight">\(\nu &gt; 0\)</span>: <strong>smoothness</strong> of the stochastic process represented by the correlation function (see <a class="reference internal" href="#nu" title="nu"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nu</span></code></a>).</p></li>
</ul>
</div></blockquote>
<p>When <span class="math notranslate nohighlight">\(\| \boldsymbol{x} - \boldsymbol{x}' \| = 0\)</span>, the correlation function is defined to be <span class="math notranslate nohighlight">\(1\)</span>. This corresponds to the diagonals of the correlation matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> as the correlation between <span class="math notranslate nohighlight">\(\boldsymbol{x}_i\)</span> with itself.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When the distance <span class="math notranslate nohighlight">\(\| \boldsymbol{x} - \boldsymbol{x}' \| \to 0^+\)</span>, the correlation function produces
<span class="math notranslate nohighlight">\(\frac{0}{0}\)</span>. Thus, if the distance is <em>not</em> exactly zero, but close to zero, this function might produce unstable results.</p>
</div>
<p>If <span class="math notranslate nohighlight">\(\nu\)</span> is half integer, the Matern function has exponential form.</p>
<ul>
<li><p>At <span class="math notranslate nohighlight">\(\nu = \frac{1}{2}\)</span>, the Matern correlation function is just the exponential decay function</p>
<div class="math notranslate nohighlight">
\[K(\boldsymbol{x},\boldsymbol{x}'|\rho,\nu) =
\exp \left( -\frac{\| \boldsymbol{x} - \boldsymbol{x}'\|}{\rho} \right)\]</div>
</li>
<li><p>At <span class="math notranslate nohighlight">\(\nu = \frac{3}{2}\)</span></p>
<div class="math notranslate nohighlight">
\[K(\boldsymbol{x},\boldsymbol{x}'|\rho,\nu) =
\left( 1 + \sqrt{3} \frac{\| \boldsymbol{x} - \boldsymbol{x}'\|}{\rho} \right)
\exp \left( - \sqrt{3} \frac{\| \boldsymbol{x} - \boldsymbol{x}'\|}{\rho} \right)\]</div>
</li>
<li><p>At <span class="math notranslate nohighlight">\(\nu = \frac{5}{2}\)</span></p>
<div class="math notranslate nohighlight">
\[K(\boldsymbol{x},\boldsymbol{x}'|\rho,\nu) =
\left( 1 + \sqrt{5} \frac{\| \boldsymbol{x} - \boldsymbol{x}'\|}{\rho} + \frac{5}{3} \frac{\| \boldsymbol{x} - \boldsymbol{x}'\|^2}{\rho^2} \right)
\exp \left( -\sqrt{5} \frac{\| \boldsymbol{x} - \boldsymbol{x}'\|}{\rho} \right)\]</div>
</li>
<li><p>At <span class="math notranslate nohighlight">\(\nu = \infty\)</span>, the Matern function approaches the <em>Gaussian correlation function</em> (also known as square exponential decay function):</p>
<div class="math notranslate nohighlight">
\[K(\boldsymbol{x},\boldsymbol{x}'|\rho,\nu) =
\exp \left( -\frac{1}{2} \frac{\| \boldsymbol{x} - \boldsymbol{x}'\|^2}{\rho^2} \right)\]</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At <span class="math notranslate nohighlight">\(\nu &gt; 100\)</span>, this module assumes that <span class="math notranslate nohighlight">\(\nu = \infty\)</span> and the Gaussian correlation function is used.</p>
</div>
</section>
<section id="sparse-matrix">
<h3>Sparse Matrix<a class="headerlink" href="#sparse-matrix" title="Permalink to this headline">¶</a></h3>
<p>To produce a sparse matrix, a compactly supported kernel is used by tapering the tail of the correlation function <span class="math notranslate nohighlight">\(K\)</span>. Define the <em>indicator function</em></p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{1}_{K &gt; \kappa}(\boldsymbol{x},\boldsymbol{x}') =
\begin{cases}
    1, &amp; K &gt; \kappa \\
    0, &amp; K \leq \kappa \\
\end{cases}\end{split}\]</div>
<p>The parameter <span class="math notranslate nohighlight">\(\kappa\)</span> is the threshold of the indicator function (see <a class="reference internal" href="#KernelThreshold" title="KernelThreshold"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelThreshold</span></code></a>). By multiplying the indicator function <span class="math notranslate nohighlight">\(\mathbf{1}_{K &gt; \kappa}\)</span> with the correlation kernel <span class="math notranslate nohighlight">\(K\)</span>, any correlation value less than the threshold <span class="math notranslate nohighlight">\(\kappa\)</span> becomes zero, hence makes the correlation matrix sparse.</p>
<p>The <em>sparse density</em> <span class="math notranslate nohighlight">\(d\)</span> of the sparse matrix (ratio of non-zero elements over all elements) is</p>
<div class="math notranslate nohighlight">
\[d = \pi \left( \rho \log \kappa \right)^2\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the threshold <span class="math notranslate nohighlight">\(\kappa\)</span> is too large, the sparse matrix might no longer be positive-definite <a class="reference internal" href="#genton-2002" id="id5"><span>[Genton-2002]</span></a>. On the other hand, if <span class="math notranslate nohighlight">\(\kappa\)</span> is not small enough, the matrix will not be sparse enough.</p>
</div>
</section>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Generate a matrix of the size <span class="math notranslate nohighlight">\(20^2 \times 20^2\)</span> based on mutual correlation of a rectangular grid of <span class="math notranslate nohighlight">\(20 \times 20\)</span> points in the unit square</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">imate</span> <span class="kn">import</span> <span class="n">generate_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">generate_matrix</span><span class="p">(</span><span class="n">NumPoints</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>Generate a correlation matrix of the size <span class="math notranslate nohighlight">\(20 \times 20\)</span> based on <span class="math notranslate nohighlight">\(20\)</span> random points in unit square. Default for <a class="reference internal" href="#GridOfPoints" title="GridOfPoints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GridOfPoints</span></code></a> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">generate_matrix</span><span class="p">(</span><span class="n">NumPoints</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">GridOfPoints</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Generate a matrix of the size <span class="math notranslate nohighlight">\(20^2 \times 20^2\)</span> with stronger spatial correlation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">generate_matrix</span><span class="p">(</span><span class="n">NumPoints</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">DecorrelationScale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<p>Generate a correlation matrix with more smoothness.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">generate_matrix</span><span class="p">(</span><span class="n">NumPoints</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nu</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Sparsify correlation matrix (makes all entries below <a class="reference internal" href="#KernelThreshold" title="KernelThreshold"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelThreshold</span></code></a> to zero).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">generate_matrix</span><span class="p">(</span><span class="n">NumPoints</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">UseSparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">KernelThreshold</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
</pre></div>
</div>
<p>For very large correlation matrices, generate the rows and columns are generated in parallel.
To use <a class="reference internal" href="#RunInParallel" title="RunInParallel"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RunInParallel</span></code></a> option, the package <code class="docutils literal notranslate"><span class="pre">ray</span></code> should be installed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">generate_matrix</span><span class="p">(</span><span class="n">NumPoints</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">UseSparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">RunInParallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the matrix using <a class="reference internal" href="#Plot" title="Plot"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Plot</span></code></a> option:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">generate_matrix</span><span class="p">(</span><span class="n">NumPoints</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">DecorrelationScale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">Plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="old/images/CorrelationMatrix.svg" class="align-center" src="old/images/CorrelationMatrix.svg" /></section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="matern-1960"><span class="brackets"><a class="fn-backref" href="#id1">Matern-1960</a></span></dt>
<dd><p>Matérn, B. (1960). Spatial variation. In <em>Meddelanden från Statens Skogsforskningsinstitut</em>, volume 49, No. 5. Almänna Förlaget, Stockholm. Second edition (1986), Springer-Verlag, Berlin. <a class="reference external" href="https://www.springer.com/gp/book/9781461578925">doi: 10.1007/978-1-4615-7892-5</a></p>
</dd>
<dt class="label" id="genton-2002"><span class="brackets"><a class="fn-backref" href="#id5">Genton-2002</a></span></dt>
<dd><p>Genton, M. G. (2002). Classes of kernels for machine learning: A statistics perspective. <em>Journal of Machine Learning Research</em>, 2, 299–312. <a class="reference external" href="https://dl.acm.org/doi/10.5555/944790.944815">doi: 10.5555/944790.944815</a></p>
</dd>
<dt class="label" id="stein-1999"><span class="brackets"><a class="fn-backref" href="#id2">Stein-1999</a></span></dt>
<dd><p>Stein, M. L. (1999). Interpolation of Spatial Data: Some Theory for Kriging. Springer Series in Statistics. Springer New York. <a class="reference external" href="https://www.springer.com/gp/book/9780387986296">doi: 10.1007/978-1-4612-1494-6</a></p>
</dd>
<dt class="label" id="dlmf"><span class="brackets">DLMF</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id4">2</a>)</span></dt>
<dd><p><a class="reference external" href="http://dlmf.nist.gov/">NIST Digital Library of Mathematical Functions.</a>, F. W. J. Olver, A. B. Olde Daalhuis, D. W. Lozier, B. I. Schneider, R. F. Boisvert, C. W. Clark, B. R. Miller, B. V. Saunders, H. S. Cohl, and M. A. McClain, eds. <a class="reference external" href="https://doi.org/10.1023/A:1022915830921">doi: 10.1023/A:1022915830921</a></p>
</dd>
</dl>
</section>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Siavash Ameli.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>



<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Examples &#8212; imate Manual</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/toggleprompt.js"></script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">imate</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../introduction.html">
  Introduction
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../install.html">
  Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../quickstart.html">
  Quick Start
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../notes.html">
  Notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ameli/imate" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-1">
   Example 1
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-2">
   Example 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-3">
   Example 3
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="examples">
<span id="allexamples"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>Three examples are provided in <a class="reference external" href="https://github.com/ameli/imate/blob/main/examples"><code class="docutils literal notranslate"><span class="pre">/examples</span></code></a>, which aim to reproduce the figures presented in <a class="reference internal" href="InterpolateTraceOfInverse.html#ameli-2020" id="id1"><span>[Ameli-2020]</span></a>. Namely, in that reference,</p>
<ul class="simple">
<li><p><strong>Example 1:</strong> Script <a class="reference external" href="https://github.com/ameli/imate/blob/main/examples/Plot_imate_FullRank.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_imate_FullRank.py</span></code></a> reproduces Figure 2.</p></li>
<li><p><strong>Example 2:</strong> Script <a class="reference external" href="https://github.com/ameli/imate/blob/main/examples/Plot_imate_IllConditioned.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_imate_IllConditioned.py</span></code></a> reproduces Figure 3.</p></li>
<li><p><strong>Example 3:</strong> Script <a class="reference external" href="https://github.com/ameli/imate/blob/main/examples/Plot_GeneralizedCrossValidation.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_GeneralizedCorssValidation.py</span></code></a> reproduces Figure 4 and generates the results of Table 2.</p></li>
</ul>
<dl>
<dt>Before running examples:</dt><dd><p>To run the examples, you may not need to install the <code class="docutils literal notranslate"><span class="pre">imate</span></code> package. Rather, download the source code and install requirements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ameli</span><span class="o">/</span><span class="n">imate</span><span class="o">.</span><span class="n">git</span>

<span class="c1"># Install prerequisite packages</span>
<span class="n">cd</span> <span class="n">imate</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Then, run either of the examples as described below.</p>
</dd>
</dl>
<section id="example-1">
<span id="example-one"></span><h2>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h2>
<p>The script <a class="reference external" href="https://github.com/ameli/imate/blob/main/examples/Plot_imate_FullRank.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_imate_FullRank.py</span></code></a> plots the interpolation of the function</p>
<div class="math notranslate nohighlight">
\[\tau(t) = \mathrm{trace} \left( (\mathbf{A} + t \mathbf{I})^{-1} \right)\]</div>
<p>using <strong>Root Monomial basis Function</strong> method. Here, <span class="math notranslate nohighlight">\(\mathbf{I}\)</span> is the identity matrix, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a dense full-rank correlation matrix of the size <span class="math notranslate nohighlight">\(50^2 \times 50^2\)</span>, and <span class="math notranslate nohighlight">\(t \in [10^{-4},10^3]\)</span>.</p>
<p>Run this example by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">Plot_imate_FullRank</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The script generates the figure below (see Figure 2 of <a class="reference internal" href="InterpolateTraceOfInverse.html#ameli-2020" id="id2"><span>[Ameli-2020]</span></a>).</p>
<img alt="old/images/Example1.svg" class="align-center" src="old/images/Example1.svg" /><p>The plot on the left shows the interpolation of <span class="math notranslate nohighlight">\(\tau(t)\)</span>. Each colored curve is obtained using different number of interpolant points <span class="math notranslate nohighlight">\(p\)</span>. The plot on the right represents the relative error  of interpolation compared to the accurate computation when no interpolation is applied. Clearly, employing more interpolant points (such as the red curve with <span class="math notranslate nohighlight">\(p = 9\)</span> interpolant points) yield smaller interpolation error.</p>
</section>
<section id="example-2">
<span id="example-two"></span><h2>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h2>
<p>The script <a class="reference external" href="https://github.com/ameli/imate/blob/main/examples/Plot_imate_IllConditioned.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_imate_IllConditioned.py</span></code></a> plots the interpolation of the function <span class="math notranslate nohighlight">\(\tau(t)\)</span> as defined in <span class="xref std std-ref">Example 1</span>, however, here, the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[\mathbf{A} = \mathbf{X}^{\intercal} \mathbf{X} + s \mathbf{I}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is an ill-conditioned matrix of the size <span class="math notranslate nohighlight">\(1000 \times 500\)</span>, and the fixed shift parameter <span class="math notranslate nohighlight">\(s=10^{-3}\)</span> is applied to improve the condition number of the matrix to become invertible.</p>
<p>The interpolation is performed using <strong>Rational Polynomial Function</strong> method for <span class="math notranslate nohighlight">\(t \in [-10^{-3},10^{3}]\)</span>.</p>
<p>Run this example by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">Plot_imate_IllConditioned</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The script generates the figure below (see also  Figure 3 of <a class="reference internal" href="InterpolateTraceOfInverse.html#ameli-2020" id="id3"><span>[Ameli-2020]</span></a>).</p>
<img alt="old/images/Example2.svg" class="align-center" src="old/images/Example2.svg" /></section>
<section id="example-3">
<span id="example-three"></span><h2>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h2>
<p>The script <a class="reference external" href="https://github.com/ameli/imate/blob/main/examples/Plot_GeneralizedCrossValidation.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_GeneralizedCorssValidation.py</span></code></a> plots the <a class="reference external" href="https://www.jstor.org/stable/1390722?seq=1">Generalized Cross-validation</a> function</p>
<div class="math notranslate nohighlight">
\[V(\theta) = \frac{\frac{1}{n} \| \mathbf{I} - \mathbf{X} (\mathbf{X}^{\intercal} \mathbf{X} + n \theta \mathbf{I})^{-1} \mathbf{X}^{\intercal} \boldsymbol{z} \|_2^2}{\left( \frac{1}{n} \mathrm{trace}\left( (\mathbf{I} - \mathbf{X}(\mathbf{X}^{\intercal} \mathbf{X} + n \theta \mathbf{I})^{-1})\mathbf{X}^{\intercal} \right) \right)^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is the same matrix as <span class="xref std std-ref">Example 2</span> and the term involving the trace of inverse in the denominator is interpolated as presented in <span class="xref std std-ref">Example 2</span>.</p>
<p>Run this example by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">Plot_GeneralizedCrossValidation</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The script generates the figure below and prints the processing times of the computations. See more details in Figure 3 and results of Table 2 of <a class="reference internal" href="InterpolateTraceOfInverse.html#ameli-2020" id="id4"><span>[Ameli-2020]</span></a>.</p>
<a class="reference internal image-reference" href="old/images/GeneralizedCrossValidation.svg"><img alt="old/images/GeneralizedCrossValidation.svg" class="align-center" src="old/images/GeneralizedCrossValidation.svg" width="550" /></a>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Siavash Ameli.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>
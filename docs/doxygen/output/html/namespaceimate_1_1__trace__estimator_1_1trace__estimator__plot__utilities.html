<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>imate: imate._trace_estimator.trace_estimator_plot_utilities Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "TeX/AMSfonts.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ameli/imate" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-imate-light.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">imate
   </div>
   <div id="projectbrief">C++/CUDA Reference</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">imate._trace_estimator.trace_estimator_plot_utilities Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4856b82b9c4a9d17e5c2be1c505a010d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a4856b82b9c4a9d17e5c2be1c505a010d">_remove_outliers</a> (samples, samples_processed_order, num_samples_used, outlier_confidence_level)</td></tr>
<tr class="separator:a4856b82b9c4a9d17e5c2be1c505a010d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d29de8d95a73fda97ac3868aadddfc"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ab9d29de8d95a73fda97ac3868aadddfc">_compute_cumulative_statistics</a> (samples, samples_processed_order, num_samples_used, confidence_level)</td></tr>
<tr class="separator:ab9d29de8d95a73fda97ac3868aadddfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7047cd3e950939f55c0351853e756e1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ad7047cd3e950939f55c0351853e756e1">_plot_samples</a> (ax, samples, samples_processed_order, num_samples_used, confidence_level, cumulative_mean, cumulative_abs_error)</td></tr>
<tr class="separator:ad7047cd3e950939f55c0351853e756e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac297a0e6e32b51a8fc6308b93c724869"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ac297a0e6e32b51a8fc6308b93c724869">_plot_error</a> (ax, num_samples_used, min_num_samples, max_num_samples, error_atol, error_rtol, converged, cumulative_abs_error, cumulative_rel_error)</td></tr>
<tr class="separator:ac297a0e6e32b51a8fc6308b93c724869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5b11b077873546cc4bd81e9d38c991"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991">plot_convergence</a> (info)</td></tr>
<tr class="separator:a5b5b11b077873546cc4bd81e9d38c991"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5493bc208abc22214cc40ed200d4be3b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5493bc208abc22214cc40ed200d4be3b">plot_modules_exist</a> = True</td></tr>
<tr class="separator:a5493bc208abc22214cc40ed200d4be3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a980131643214ef893ac370c8923b67c6"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a980131643214ef893ac370c8923b67c6">__all__</a> = ['<a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991">plot_convergence</a>']</td></tr>
<tr class="separator:a980131643214ef893ac370c8923b67c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab9d29de8d95a73fda97ac3868aadddfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9d29de8d95a73fda97ac3868aadddfc">&#9670;&nbsp;</a></span>_compute_cumulative_statistics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def imate._trace_estimator.trace_estimator_plot_utilities._compute_cumulative_statistics </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples_processed_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_samples_used</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>confidence_level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Computes mean and error as the number of samples progresses. The output
are the means, absolute and relative errors of the samples.

The cumulative here refers to the progressive mean or error of the samples
from the first to the current row as the row progresses by introducing more
rows to the samples data. For example, the i-th row and j-th column of the
cumulative mean is the mean of rows 0:i-1 and j-th column of samples.

:param samples: 2D array of size ``(max_num_samples, num_inquiry)``. Each
    column is the set of all samples for an inquiry. Some of these samples
    might be nan, because, often, the convergence is achieved sooner than
    ``max_num_samples``, hence, with the fewer number of processed rows,
    the remaining elements in a row remain nan.
:type: numpy.ndarray

:param samples_processed_order: Due to parallel processing, the rows of the
    ``samples`` array are not processed sequentially. This 1D array of size
    ``max_num_samples`` keeps the record of the process order of the rows
    of ``samples``.
:type samples_process_order: numpy.ndarray

:param num_samples_used: 1D array of size ``num_inquiry``. The j-th
    element is the number of valid (non-nan) rows of the j-th column of
    ``samples``. Thus, it indicates how many samples exists for the j-th
    inquiry out of the max number of samples.
:type num_samples_used: numpy.ndarray

:param confidence_level: The confidence level of the error, which is
    between ``0`` and ``1``. For example, the confidence level of ``0.95``
    means that the confidence region consists of 95% of the area under the
    normal distribution of the samples.
:type confidence_level: float

:return: A list of cumulative mean, absolute error, and relative error.
    Each of these three arrays have the same shape as ``samples``.
:rtype: list
</pre> 
<p class="definition">Definition at line <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00109">109</a> of file <a class="el" href="trace__estimator__plot__utilities_8py_source.html">trace_estimator_plot_utilities.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        confidence_level):</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="stringliteral">    Computes mean and error as the number of samples progresses. The output</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="stringliteral">    are the means, absolute and relative errors of the samples.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="stringliteral">    The cumulative here refers to the progressive mean or error of the samples</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="stringliteral">    from the first to the current row as the row progresses by introducing more</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="stringliteral">    rows to the samples data. For example, the i-th row and j-th column of the</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="stringliteral">    cumulative mean is the mean of rows 0:i-1 and j-th column of samples.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="stringliteral">    :param samples: 2D array of size ``(max_num_samples, num_inquiry)``. Each</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="stringliteral">        column is the set of all samples for an inquiry. Some of these samples</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="stringliteral">        might be nan, because, often, the convergence is achieved sooner than</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="stringliteral">        ``max_num_samples``, hence, with the fewer number of processed rows,</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="stringliteral">        the remaining elements in a row remain nan.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="stringliteral">    :type: numpy.ndarray</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="stringliteral">    :param samples_processed_order: Due to parallel processing, the rows of the</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="stringliteral">        ``samples`` array are not processed sequentially. This 1D array of size</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral">        ``max_num_samples`` keeps the record of the process order of the rows</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">        of ``samples``.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">    :type samples_process_order: numpy.ndarray</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral">    :param num_samples_used: 1D array of size ``num_inquiry``. The j-th</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral">        element is the number of valid (non-nan) rows of the j-th column of</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="stringliteral">        ``samples``. Thus, it indicates how many samples exists for the j-th</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="stringliteral">        inquiry out of the max number of samples.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="stringliteral">    :type num_samples_used: numpy.ndarray</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="stringliteral">    :param confidence_level: The confidence level of the error, which is</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="stringliteral">        between ``0`` and ``1``. For example, the confidence level of ``0.95``</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral">        means that the confidence region consists of 95% of the area under the</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral">        normal distribution of the samples.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral">    :type confidence_level: float</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="stringliteral">    :return: A list of cumulative mean, absolute error, and relative error.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="stringliteral">        Each of these three arrays have the same shape as ``samples``.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="stringliteral">    :rtype: list</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment"># Allocate arrays</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    cumulative_mean = numpy.empty_like(samples)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    cumulative_abs_error = numpy.empty_like(samples)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    cumulative_rel_error = numpy.empty_like(samples)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment"># Set arrays to nan</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    cumulative_mean[:, :] = numpy.nan</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    cumulative_abs_error[:, :] = numpy.nan</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    cumulative_rel_error[:, :] = numpy.nan</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment"># Quantile based on the confidence level</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    quantile = numpy.sqrt(2) * scipy.special.erfinv(confidence_level)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    num_inquiries = samples.shape[1]</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(num_inquiries):</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(num_samples_used[j]):</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="comment"># Find the non-nan elements of the j-th column of samples from the</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="comment"># first to the i-th processed element</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            sample_indices = samples_processed_order[:i+1]</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            samples_valid = samples[sample_indices, j]</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            samples_valid = samples_valid[~numpy.isnan(samples_valid)]</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">if</span> samples_valid.size == 0:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="comment"># This might happen on the first processed row</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                cumulative_mean[i, j] = numpy.nan</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                cumulative_abs_error[i, j] = numpy.nan</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                cumulative_rel_error[i, j] = numpy.nan</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="comment"># Compute mean and errors</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                cumulative_mean[i, j] = numpy.nanmean(samples_valid)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                standard_deviation = numpy.nanstd(samples_valid)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                cumulative_abs_error[i, j] = \</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    quantile * standard_deviation / numpy.sqrt(i+1)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                cumulative_rel_error[i, j] = \</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    cumulative_abs_error[i, j] / cumulative_mean[i, j]</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> cumulative_mean, cumulative_abs_error, cumulative_rel_error</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"># ============</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"># plot samples</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"># ============</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00512">imate._trace_estimator.trace_estimator_plot_utilities.plot_convergence()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ab9d29de8d95a73fda97ac3868aadddfc_icgraph.png" border="0" usemap="#anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ab9d29de8d95a73fda97ac3868aadddfc_icgraph" alt=""/></div>
<map name="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ab9d29de8d95a73fda97ac3868aadddfc_icgraph" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ab9d29de8d95a73fda97ac3868aadddfc_icgraph">
<area shape="rect" title=" " alt="" coords="2631,300,2840,356"/>
<area shape="rect" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991" title=" " alt="" coords="2396,300,2583,356"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1__hutchinson__method.html#a62c0bc37cf02ed8dddf9d15fd56112ed" title=" " alt="" coords="2159,307,2348,349"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1traceinv.html#af09d9b0af1471fa625846f791debb269" title=" " alt="" coords="1911,315,2111,341"/>
<area shape="rect" href="namespaceimate_1_1schatten_1_1schatten.html#addd398048ffe6f31c8401438d3ab708e" title=" " alt="" coords="1647,315,1863,341"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ac280d2903b95eebb4f52d53a39f9814b" title=" " alt="" coords="1409,300,1599,356"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a413ec50ad36453760a7640af0d254aa5" title=" " alt="" coords="1172,256,1361,312"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#af4dff8144fb18580899069269f2f57eb" title=" " alt="" coords="1172,337,1361,407"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ae34c18fb577fc57bcf0f70cc0a86d073" title=" " alt="" coords="935,260,1124,316"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ab536b71b179a86e3c869f7b1f5e1a113" title=" " alt="" coords="935,180,1124,236"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#aa0fab44823eefba8f131db3cac2b657f" title=" " alt="" coords="628,5,829,61"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#ab6500d8ed781a3dc971e9c06e856b58f" title=" " alt="" coords="299,107,499,163"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a9cbdbcf5477fa0f629bfc90b96124d47" title=" " alt="" coords="299,27,499,83"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__monomial__basis__functions__method_1_1MonomialBasisFunctionsMethod.html#a805c6eb66a8397506be953f71f1f0266" title=" " alt="" coords="571,355,887,426"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__exact__method_1_1ExactMethod.html#ab3fca349a29a103f4496e1c8593fb2a0" title=" " alt="" coords="601,187,857,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__logdet_1_1InterpolateLogdet.html#af80d3805ea6303c00baf4f1e92d79652" title=" " alt="" coords="302,253,495,294"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__trace_1_1InterpolateTrace.html#a38158704798314a5ea2a5d3f9fb2a226" title=" " alt="" coords="306,318,491,359"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a730f165dfcdbdf27fc062b383ee6845a" title=" " alt="" coords="5,114,227,155"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a8d73f3cded7d501f9563ce09ff9951e4" title=" " alt="" coords="275,187,523,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a8518f8ac4e73004e17323152e1dbbd27" title=" " alt="" coords="935,344,1124,400"/>
</map>
</div>

</div>
</div>
<a id="ac297a0e6e32b51a8fc6308b93c724869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac297a0e6e32b51a8fc6308b93c724869">&#9670;&nbsp;</a></span>_plot_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def imate._trace_estimator.trace_estimator_plot_utilities._plot_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_samples_used</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>error_atol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>error_rtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>converged</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cumulative_abs_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cumulative_rel_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Plots cumulative errors. When ``num_inquiries`` is ``1``, it plots both
absolute and relative errors (on left and right y axes) on the same axes.
However, when ``num_inquiries`` is more than one, it only plots the
relative error. This is because, with the multiple number of inquiries, the
absolute error of each can be on different plot scales and they cannot be
contained in the same scale of the plot.

:param ax: axes object
:type ax: numpy.ndarray

:param num_samples_used: 1D array of size ``num_inquiry``. The j-th
    element is the number of valid (non-nan) rows of the j-th column of
    ``samples``. Thus, it indicates how many samples exists for the j-th
    inquiry out of the max number of samples. Note that this is different
    than ``num_samples_processed``, because the j-th column might converge
    sooner than others and thus, less number of samples were used for it.
:type num_samples_used: numpy.ndarray

:param min_num_samples: Minimum number of samples. In the iterations below
    this number, the convergence is now checked.
:type min_num_samples: int

:param max_num_samples: Maximum number of samples. This is also the number
    of row of ``samples`` array.
:type max_num_samples: int

:param error_atol: Absolute error tolerance
:type error_atol: float

:param error_rtol: Relative error tolerance
:type error_rtol: float

:param converged: 1D boolean array of size ``num_inquiries`` and indicates
    which of the inquiries are converged at their final state.
:type converged: numpy.ndarray

:param cumulative_abs_error: 2D array of size ``(max_num_samples,
    num_inqiries).
:type cumulative_abs_error: numpy.ndarray

:param cumulative_rel_error: 2D array of size ``(max_num_samples,
    num_inqiries).
:type cumulative_rel_error: numpy.ndarray
</pre> 
<p class="definition">Definition at line <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00306">306</a> of file <a class="el" href="trace__estimator__plot__utilities_8py_source.html">trace_estimator_plot_utilities.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        cumulative_rel_error):</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="stringliteral">    Plots cumulative errors. When ``num_inquiries`` is ``1``, it plots both</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="stringliteral">    absolute and relative errors (on left and right y axes) on the same axes.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="stringliteral">    However, when ``num_inquiries`` is more than one, it only plots the</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="stringliteral">    relative error. This is because, with the multiple number of inquiries, the</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="stringliteral">    absolute error of each can be on different plot scales and they cannot be</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="stringliteral">    contained in the same scale of the plot.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="stringliteral">    :param ax: axes object</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="stringliteral">    :type ax: numpy.ndarray</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="stringliteral">    :param num_samples_used: 1D array of size ``num_inquiry``. The j-th</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="stringliteral">        element is the number of valid (non-nan) rows of the j-th column of</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="stringliteral">        ``samples``. Thus, it indicates how many samples exists for the j-th</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="stringliteral">        inquiry out of the max number of samples. Note that this is different</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="stringliteral">        than ``num_samples_processed``, because the j-th column might converge</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="stringliteral">        sooner than others and thus, less number of samples were used for it.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="stringliteral">    :type num_samples_used: numpy.ndarray</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="stringliteral">    :param min_num_samples: Minimum number of samples. In the iterations below</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="stringliteral">        this number, the convergence is now checked.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="stringliteral">    :type min_num_samples: int</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="stringliteral">    :param max_num_samples: Maximum number of samples. This is also the number</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="stringliteral">        of row of ``samples`` array.</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="stringliteral">    :type max_num_samples: int</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="stringliteral">    :param error_atol: Absolute error tolerance</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="stringliteral">    :type error_atol: float</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="stringliteral">    :param error_rtol: Relative error tolerance</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="stringliteral">    :type error_rtol: float</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="stringliteral">    :param converged: 1D boolean array of size ``num_inquiries`` and indicates</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="stringliteral">        which of the inquiries are converged at their final state.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="stringliteral">    :type converged: numpy.ndarray</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="stringliteral">    :param cumulative_abs_error: 2D array of size ``(max_num_samples,</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="stringliteral">        num_inqiries).</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="stringliteral">    :type cumulative_abs_error: numpy.ndarray</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="stringliteral">    :param cumulative_rel_error: 2D array of size ``(max_num_samples,</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="stringliteral">        num_inqiries).</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="stringliteral">    :type cumulative_rel_error: numpy.ndarray</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> plot_modules_exist:</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">raise</span> ImportError(<span class="stringliteral">&#39;Cannot import modules for plotting. Either &#39;</span> +</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                          <span class="stringliteral">&#39;install &quot;matplotlib&quot; and &quot;seaborn&quot; packages, &#39;</span> +</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                          <span class="stringliteral">&#39;or set &quot;plot=False&quot;.&#39;</span>)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment"># Load plot settings</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="namespaceimate_1_1__utilities_1_1plot__utilities.html#ac5be3859295616ee4d82fdcaab5faedd">load_plot_settings</a>()</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">except</span> ImportError:</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">raise</span> ImportError(<span class="stringliteral">&#39;Cannot import modules for plotting. Either &#39;</span> +</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                          <span class="stringliteral">&#39;install &quot;matplotlib&quot; and &quot;seaborn&quot; packages, &#39;</span> +</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                          <span class="stringliteral">&#39;or set &quot;plot=False&quot;.&#39;</span>)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    relative_color = <span class="stringliteral">&#39;black&#39;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    absolute_color = <span class="stringliteral">&#39;darkgrey&#39;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    num_inquiries = cumulative_abs_error.shape[1]</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span> num_inquiries == 1:</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        ax2 = ax.twinx()</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment"># Scale the twin y axis (for absolute error) so that the final value of</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment"># the relative and absolute plots match</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    max_rel_error = numpy.nanmax(numpy.nanmax(cumulative_rel_error)) * 100.0</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    final_abs_error = cumulative_abs_error[num_samples_used[0]-1, 0]</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    final_rel_error = cumulative_rel_error[num_samples_used[0]-1, 0] * 100.0</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment"># Match the high of the final value of the absolute error with relative</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    ylim_abs_plot = final_abs_error * max_rel_error / final_rel_error</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment"># Extra space for the y axis limit</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    ylim_scale = 1.1</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    x_min = 1</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    x_max = numpy.max(num_samples_used)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment"># Colormaps</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span> num_inquiries &gt; 1:</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment"># Concatenate two colormaps, in total, 18 colors</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        colors1 = matplotlib.cm.tab10.colors</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        colors2 = matplotlib.cm.Dark2.colors</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        colors = numpy.r_[colors1, colors2]</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        colors = [<span class="stringliteral">&#39;black&#39;</span>]</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">for</span> inquiry <span class="keywordflow">in</span> range(num_inquiries):</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment"># Abscissa</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        x = 1 + numpy.arange(num_samples_used[inquiry])</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="comment"># Get relative and absolute errors for each inquiry</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        _num_samples_used = num_samples_used[inquiry]</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        _rel_error = cumulative_rel_error[:_num_samples_used, inquiry] * 100.0</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        _abs_error = cumulative_abs_error[:_num_samples_used, inquiry]</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment"># With more than one inquiry, do not plot absolute error</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">if</span> num_inquiries == 1:</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            ax2.plot(x, _abs_error, color=absolute_color,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                     label=<span class="stringliteral">&#39;absolute error&#39;</span>)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            ax.plot(x, _rel_error, color=relative_color,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    label=<span class="stringliteral">&#39;relative error&#39;</span>)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            ax.plot(x, _rel_error, color=colors[inquiry],</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    label=<span class="stringliteral">&#39;inquiry: %d&#39;</span> % (inquiry+1))</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment"># Relative error tolerance limit line</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    ax.plot([x_min, max_num_samples], [error_rtol, error_rtol],</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="stringliteral">&#39;--&#39;</span>, color=relative_color, label=<span class="stringliteral">&#39;relative error tol&#39;</span>)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> num_inquiries == 1:</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment"># Absolute error tolerance limit line</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        ax2.plot([x_min, max_num_samples], [error_atol, error_atol],</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                 <span class="stringliteral">&#39;--&#39;</span>, color=absolute_color, label=<span class="stringliteral">&#39;absolute error tol&#39;</span>)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment"># Vertical dotted line showing where the min_num_samples starts</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    ax.plot([min_num_samples, min_num_samples], [0., max_rel_error*ylim_scale],</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="stringliteral">&#39;:&#39;</span>, color=<span class="stringliteral">&#39;grey&#39;</span>, label=<span class="stringliteral">&#39;min num samples&#39;</span>)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment"># Plot a dot at each converged point</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    dot_label_inserted = <span class="keyword">False</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">for</span> inquiry <span class="keywordflow">in</span> range(num_inquiries):</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        x = 1 + numpy.arange(num_samples_used[inquiry])</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        _num_samples_used = num_samples_used[inquiry]</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        _rel_error = cumulative_rel_error[:_num_samples_used, inquiry] * 100.0</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        _abs_error = cumulative_abs_error[:_num_samples_used, inquiry]</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> converged[inquiry]:</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="comment"># Insert a label for dot only once</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> dot_label_inserted:</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                dot_label_inserted = <span class="keyword">True</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                ax.plot(x[-1], _rel_error[-1], <span class="stringliteral">&#39;o&#39;</span>, color=colors[inquiry],</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                        zorder=20, markersize=4, label=<span class="stringliteral">&#39;convergence reached&#39;</span>)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                ax.plot(x[-1], _rel_error[-1], <span class="stringliteral">&#39;o&#39;</span>, color=colors[inquiry],</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                        zorder=20, markersize=4)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment"># Before min_num_samples and after max_num_samples, shade plot background</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    ax.axvspan(x_min, min_num_samples, color=<span class="stringliteral">&#39;grey&#39;</span>, alpha=0.2, lw=0,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;               label=<span class="stringliteral">&#39;convergence skipped&#39;</span>)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    ax.axvspan(x_max, max_num_samples, color=<span class="stringliteral">&#39;grey&#39;</span>, alpha=0.07, lw=0)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    ax.set_xlabel(<span class="stringliteral">&#39;sample index&#39;</span>)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    ax.set_ylabel(<span class="stringliteral">&#39;relative error&#39;</span>)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    ax.set_title(<span class="stringliteral">&#39;Convergence of Errors&#39;</span>)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    ax.set_xlim([x_min, max_num_samples])</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    ax.set_ylim([0, max_rel_error*ylim_scale])</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment"># Display yticks as percent</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    ax.yaxis.set_major_formatter(matplotlib.ticker.PercentFormatter())</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment"># Ensure x ticks are integers</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    ax.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=<span class="keyword">True</span>))</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span> num_inquiries == 1:</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        ax2.set_ylabel(<span class="stringliteral">&#39;absolute error&#39;</span>)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        ax2.set_ylim([0, ylim_abs_plot*ylim_scale])</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment"># Legend</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    lines, labels = ax.get_legend_handles_labels()</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> num_inquiries == 1:</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="comment"># With one inquiry, legend contains both relative and absolute plots</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="comment"># where each correspond to the left and right (twin) axis</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        lines2, labels2 = ax2.get_legend_handles_labels()</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        all_lines = lines + lines2</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        all_labels = labels + labels2</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        ax.legend(all_lines, all_labels)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">elif</span> num_inquiries &lt; 11:</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment"># With less than 11 inquiries, use single column legend</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        ax.legend(lines, labels, bbox_to_anchor=(1.01, 1.022),</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                  loc=<span class="stringliteral">&#39;upper left&#39;</span>)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment"># With equal or more than 11 inquiries, use two column legend</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        ax.legend(lines, labels, bbox_to_anchor=(1.01, 1.022),</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                  loc=<span class="stringliteral">&#39;upper left&#39;</span>, ncol=2)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment"># Bring the plots of the original axis above the plots of the twin axis</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    ax.set_zorder(1)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    ax.patch.set_visible(<span class="keyword">False</span>)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"># ================</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"># plot convergence</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"># ================</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="ttc" id="anamespaceimate_1_1__utilities_1_1plot__utilities_html_ac5be3859295616ee4d82fdcaab5faedd"><div class="ttname"><a href="namespaceimate_1_1__utilities_1_1plot__utilities.html#ac5be3859295616ee4d82fdcaab5faedd">imate._utilities.plot_utilities.load_plot_settings</a></div><div class="ttdeci">def load_plot_settings()</div><div class="ttdef"><b>Definition:</b> <a href="plot__utilities_8py_source.html#l00064">plot_utilities.py:64</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="plot__utilities_8py_source.html#l00064">imate._utilities.plot_utilities.load_plot_settings()</a>.</p>

<p class="reference">Referenced by <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00512">imate._trace_estimator.trace_estimator_plot_utilities.plot_convergence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ac297a0e6e32b51a8fc6308b93c724869_cgraph.png" border="0" usemap="#anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ac297a0e6e32b51a8fc6308b93c724869_cgraph" alt=""/></div>
<map name="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ac297a0e6e32b51a8fc6308b93c724869_cgraph" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ac297a0e6e32b51a8fc6308b93c724869_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,192,61"/>
<area shape="rect" href="namespaceimate_1_1__utilities_1_1plot__utilities.html#ac5be3859295616ee4d82fdcaab5faedd" title=" " alt="" coords="240,5,371,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ac297a0e6e32b51a8fc6308b93c724869_icgraph.png" border="0" usemap="#anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ac297a0e6e32b51a8fc6308b93c724869_icgraph" alt=""/></div>
<map name="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ac297a0e6e32b51a8fc6308b93c724869_icgraph" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ac297a0e6e32b51a8fc6308b93c724869_icgraph">
<area shape="rect" title=" " alt="" coords="2631,300,2817,356"/>
<area shape="rect" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991" title=" " alt="" coords="2396,300,2583,356"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1__hutchinson__method.html#a62c0bc37cf02ed8dddf9d15fd56112ed" title=" " alt="" coords="2159,307,2348,349"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1traceinv.html#af09d9b0af1471fa625846f791debb269" title=" " alt="" coords="1911,315,2111,341"/>
<area shape="rect" href="namespaceimate_1_1schatten_1_1schatten.html#addd398048ffe6f31c8401438d3ab708e" title=" " alt="" coords="1647,315,1863,341"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ac280d2903b95eebb4f52d53a39f9814b" title=" " alt="" coords="1409,300,1599,356"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a413ec50ad36453760a7640af0d254aa5" title=" " alt="" coords="1172,256,1361,312"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#af4dff8144fb18580899069269f2f57eb" title=" " alt="" coords="1172,337,1361,407"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ae34c18fb577fc57bcf0f70cc0a86d073" title=" " alt="" coords="935,260,1124,316"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ab536b71b179a86e3c869f7b1f5e1a113" title=" " alt="" coords="935,180,1124,236"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#aa0fab44823eefba8f131db3cac2b657f" title=" " alt="" coords="628,5,829,61"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#ab6500d8ed781a3dc971e9c06e856b58f" title=" " alt="" coords="299,107,499,163"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a9cbdbcf5477fa0f629bfc90b96124d47" title=" " alt="" coords="299,27,499,83"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__monomial__basis__functions__method_1_1MonomialBasisFunctionsMethod.html#a805c6eb66a8397506be953f71f1f0266" title=" " alt="" coords="571,355,887,426"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__exact__method_1_1ExactMethod.html#ab3fca349a29a103f4496e1c8593fb2a0" title=" " alt="" coords="601,187,857,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__logdet_1_1InterpolateLogdet.html#af80d3805ea6303c00baf4f1e92d79652" title=" " alt="" coords="302,253,495,294"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__trace_1_1InterpolateTrace.html#a38158704798314a5ea2a5d3f9fb2a226" title=" " alt="" coords="306,318,491,359"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a730f165dfcdbdf27fc062b383ee6845a" title=" " alt="" coords="5,114,227,155"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a8d73f3cded7d501f9563ce09ff9951e4" title=" " alt="" coords="275,187,523,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a8518f8ac4e73004e17323152e1dbbd27" title=" " alt="" coords="935,344,1124,400"/>
</map>
</div>

</div>
</div>
<a id="ad7047cd3e950939f55c0351853e756e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7047cd3e950939f55c0351853e756e1">&#9670;&nbsp;</a></span>_plot_samples()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def imate._trace_estimator.trace_estimator_plot_utilities._plot_samples </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples_processed_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_samples_used</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>confidence_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cumulative_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cumulative_abs_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">When ``num_inquiries`` is ``1``, this function is called to plot the
samples and their cumulative mean. When ``num_inquiries`` is more than one,
the samples of different inquiries cannot be plotted in the same axes since
the value of trace might be very difference for each case.

:param ax: axes object
:type ax: numpy.ndarray

:param samples: 2D array of size ``(max_num_samples, num_inquiry)``. Each
    column is the set of all samples for an inquiry. Some of these samples
    might be nan, because, often, the convergence is achieved sooner than
    ``max_num_samples``, hence, with the fewer number of processed rows,
    the remaining elements in a row remain nan.
:type: numpy.ndarray

:param samples_processed_order: Due to parallel processing, the rows of the
    ``samples`` array are not processed sequentially. This 1D array of size
    ``max_num_samples`` keeps the record of the process order of the rows
    of ``samples``.
:type samples_process_order: numpy.ndarray

:param num_samples_used: 1D array of size ``num_inquiry``. The j-th
    element is the number of valid (non-nan) rows of the j-th column of
    ``samples``. Thus, it indicates how many samples exists for the j-th
    inquiry out of the max number of samples. Note that this is different
    than ``num_samples_processed``, because the j-th column might converge
    sooner than others and thus, less number of samples were used for it.
:type num_samples_used: numpy.ndarray

:param confidence_level: The confidence level of the error, which is
    between ``0`` and ``1``. For example, the confidence level of ``0.95``
    means that the confidence region consists of 95% of the area under the
    normal distribution of the samples.
:type confidence_level: float

:param cumulative_mean: 2D array of size ``(max_num_samples, num_inqiries).
:type cumulative_mean: numpy.ndarray

:param cumulative_abs_error: 2D array of size ``(max_num_samples,
    num_inqiries).
:type cumulative_abs_error: numpy.ndarray
</pre> 
<p class="definition">Definition at line <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00199">199</a> of file <a class="el" href="trace__estimator__plot__utilities_8py_source.html">trace_estimator_plot_utilities.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        cumulative_abs_error):</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="stringliteral">    When ``num_inquiries`` is ``1``, this function is called to plot the</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="stringliteral">    samples and their cumulative mean. When ``num_inquiries`` is more than one,</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="stringliteral">    the samples of different inquiries cannot be plotted in the same axes since</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="stringliteral">    the value of trace might be very difference for each case.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="stringliteral">    :param ax: axes object</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="stringliteral">    :type ax: numpy.ndarray</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="stringliteral">    :param samples: 2D array of size ``(max_num_samples, num_inquiry)``. Each</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="stringliteral">        column is the set of all samples for an inquiry. Some of these samples</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="stringliteral">        might be nan, because, often, the convergence is achieved sooner than</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="stringliteral">        ``max_num_samples``, hence, with the fewer number of processed rows,</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="stringliteral">        the remaining elements in a row remain nan.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="stringliteral">    :type: numpy.ndarray</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="stringliteral">    :param samples_processed_order: Due to parallel processing, the rows of the</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="stringliteral">        ``samples`` array are not processed sequentially. This 1D array of size</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="stringliteral">        ``max_num_samples`` keeps the record of the process order of the rows</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="stringliteral">        of ``samples``.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="stringliteral">    :type samples_process_order: numpy.ndarray</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="stringliteral">    :param num_samples_used: 1D array of size ``num_inquiry``. The j-th</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="stringliteral">        element is the number of valid (non-nan) rows of the j-th column of</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="stringliteral">        ``samples``. Thus, it indicates how many samples exists for the j-th</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="stringliteral">        inquiry out of the max number of samples. Note that this is different</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="stringliteral">        than ``num_samples_processed``, because the j-th column might converge</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="stringliteral">        sooner than others and thus, less number of samples were used for it.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="stringliteral">    :type num_samples_used: numpy.ndarray</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="stringliteral">    :param confidence_level: The confidence level of the error, which is</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="stringliteral">        between ``0`` and ``1``. For example, the confidence level of ``0.95``</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="stringliteral">        means that the confidence region consists of 95% of the area under the</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="stringliteral">        normal distribution of the samples.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="stringliteral">    :type confidence_level: float</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="stringliteral">    :param cumulative_mean: 2D array of size ``(max_num_samples, num_inqiries).</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="stringliteral">    :type cumulative_mean: numpy.ndarray</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="stringliteral">    :param cumulative_abs_error: 2D array of size ``(max_num_samples,</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="stringliteral">        num_inqiries).</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="stringliteral">    :type cumulative_abs_error: numpy.ndarray</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> plot_modules_exist:</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">raise</span> ImportError(<span class="stringliteral">&#39;Cannot import modules for plotting. Either &#39;</span> +</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                          <span class="stringliteral">&#39;install &quot;matplotlib&quot; and &quot;seaborn&quot; packages, &#39;</span> +</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                          <span class="stringliteral">&#39;or set &quot;plot=False&quot;.&#39;</span>)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment"># Load plot settings</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="namespaceimate_1_1__utilities_1_1plot__utilities.html#ac5be3859295616ee4d82fdcaab5faedd">load_plot_settings</a>()</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">except</span> ImportError:</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">raise</span> ImportError(<span class="stringliteral">&#39;Cannot import modules for plotting. Either &#39;</span> +</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                          <span class="stringliteral">&#39;install &quot;matplotlib&quot; and &quot;seaborn&quot; packages, &#39;</span> +</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                          <span class="stringliteral">&#39;or set &quot;plot=False&quot;.&#39;</span>)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment"># If samples has multiple columns, only the first column (inquiry) plotted.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    inquiry = 0</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment"># abscissa</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    x = 1 + numpy.arange(num_samples_used[inquiry])</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment"># Reorder rows of samples in the same order as they were processed</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    rows_order = samples_processed_order[:num_samples_used[inquiry]]</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    _samples = samples[rows_order, inquiry]</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment"># No need to reorder the rows of cumulative mean and error, since, when</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment"># they were computed in :func:`compute_cumulative_statistics` function,</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment"># they were reordered already.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    _mean = cumulative_mean[:num_samples_used[inquiry], inquiry]</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    _abs_error = cumulative_abs_error[:num_samples_used[inquiry], inquiry]</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment"># Plot samples as points</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    ax.plot(x, _samples,  <span class="stringliteral">&#39;o&#39;</span>, markersize=4, color=<span class="stringliteral">&#39;grey&#39;</span>, label=<span class="stringliteral">&#39;estimates&#39;</span>)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment"># Plot cumulative mean</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    ax.plot(x, _mean, color=<span class="stringliteral">&#39;black&#39;</span>, label=<span class="stringliteral">&#39;mean&#39;</span>)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment"># Plot confidence region</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    ax.fill_between(x, _mean - _abs_error, _mean + _abs_error, color=<span class="stringliteral">&#39;black&#39;</span>,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    alpha=0.25,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    label=(str(100.0*confidence_level).strip(<span class="stringliteral">&#39;0&#39;</span>).strip(<span class="stringliteral">&#39;.&#39;</span>) +</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                           <span class="stringliteral">r&#39;$\%$ confidence region&#39;</span>))</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    ax.set_xlabel(<span class="stringliteral">&#39;sample index&#39;</span>)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    ax.set_ylabel(<span class="stringliteral">&#39;trace estimates&#39;</span>)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    ax.set_title(<span class="stringliteral">&#39;Stochastic Estimates and Mean of Samples&#39;</span>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    ax.set_xlim([x[0], x[-1]])</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    ax.legend()</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment"># Ensure x ticks are integers</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    ax.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=<span class="keyword">True</span>))</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"># ==========</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"># plot error</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"># ==========</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="plot__utilities_8py_source.html#l00064">imate._utilities.plot_utilities.load_plot_settings()</a>.</p>

<p class="reference">Referenced by <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00512">imate._trace_estimator.trace_estimator_plot_utilities.plot_convergence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ad7047cd3e950939f55c0351853e756e1_cgraph.png" border="0" usemap="#anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ad7047cd3e950939f55c0351853e756e1_cgraph" alt=""/></div>
<map name="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ad7047cd3e950939f55c0351853e756e1_cgraph" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ad7047cd3e950939f55c0351853e756e1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,192,61"/>
<area shape="rect" href="namespaceimate_1_1__utilities_1_1plot__utilities.html#ac5be3859295616ee4d82fdcaab5faedd" title=" " alt="" coords="240,5,371,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ad7047cd3e950939f55c0351853e756e1_icgraph.png" border="0" usemap="#anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ad7047cd3e950939f55c0351853e756e1_icgraph" alt=""/></div>
<map name="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ad7047cd3e950939f55c0351853e756e1_icgraph" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_ad7047cd3e950939f55c0351853e756e1_icgraph">
<area shape="rect" title=" " alt="" coords="2631,300,2817,356"/>
<area shape="rect" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991" title=" " alt="" coords="2396,300,2583,356"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1__hutchinson__method.html#a62c0bc37cf02ed8dddf9d15fd56112ed" title=" " alt="" coords="2159,307,2348,349"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1traceinv.html#af09d9b0af1471fa625846f791debb269" title=" " alt="" coords="1911,315,2111,341"/>
<area shape="rect" href="namespaceimate_1_1schatten_1_1schatten.html#addd398048ffe6f31c8401438d3ab708e" title=" " alt="" coords="1647,315,1863,341"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ac280d2903b95eebb4f52d53a39f9814b" title=" " alt="" coords="1409,300,1599,356"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a413ec50ad36453760a7640af0d254aa5" title=" " alt="" coords="1172,256,1361,312"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#af4dff8144fb18580899069269f2f57eb" title=" " alt="" coords="1172,337,1361,407"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ae34c18fb577fc57bcf0f70cc0a86d073" title=" " alt="" coords="935,260,1124,316"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ab536b71b179a86e3c869f7b1f5e1a113" title=" " alt="" coords="935,180,1124,236"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#aa0fab44823eefba8f131db3cac2b657f" title=" " alt="" coords="628,5,829,61"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#ab6500d8ed781a3dc971e9c06e856b58f" title=" " alt="" coords="299,107,499,163"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a9cbdbcf5477fa0f629bfc90b96124d47" title=" " alt="" coords="299,27,499,83"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__monomial__basis__functions__method_1_1MonomialBasisFunctionsMethod.html#a805c6eb66a8397506be953f71f1f0266" title=" " alt="" coords="571,355,887,426"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__exact__method_1_1ExactMethod.html#ab3fca349a29a103f4496e1c8593fb2a0" title=" " alt="" coords="601,187,857,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__logdet_1_1InterpolateLogdet.html#af80d3805ea6303c00baf4f1e92d79652" title=" " alt="" coords="302,253,495,294"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__trace_1_1InterpolateTrace.html#a38158704798314a5ea2a5d3f9fb2a226" title=" " alt="" coords="306,318,491,359"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a730f165dfcdbdf27fc062b383ee6845a" title=" " alt="" coords="5,114,227,155"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a8d73f3cded7d501f9563ce09ff9951e4" title=" " alt="" coords="275,187,523,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a8518f8ac4e73004e17323152e1dbbd27" title=" " alt="" coords="935,344,1124,400"/>
</map>
</div>

</div>
</div>
<a id="a4856b82b9c4a9d17e5c2be1c505a010d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4856b82b9c4a9d17e5c2be1c505a010d">&#9670;&nbsp;</a></span>_remove_outliers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def imate._trace_estimator.trace_estimator_plot_utilities._remove_outliers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples_processed_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_samples_used</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>outlier_confidence_level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Flags the outlier samples and sets them to nan. The outlier is defined
by those sample points that are outside of the confidence region
defined by a confidence level.

:param samples: 2D array of size ``(max_num_samples, num_inquiry)``. Each
    column is the set of all samples for an inquiry. Some of these samples
    might be nan, because, often, the convergence is achieved sooner than
    ``max_num_samples``, hence, with the fewer number of processed rows,
    the remaining elements in a row remain nan.
:type: numpy.ndarray

:param samples_processed_order: Due to parallel processing, the rows of the
    ``samples`` array are not processed sequentially. This 1D array of size
    ``max_num_samples`` keeps the record of the process order of the rows
    of ``samples``.
:type samples_process_order: numpy.ndarray

:param num_samples_used: 1D array of size ``num_inquiry``. The j-th
    element is the number of valid (non-nan) rows of the j-th column of
    ``samples``. Thus, it indicates how many samples exists for the j-th
    inquiry out of the max number of samples.
:type num_samples_used: numpy.ndarray

:param outlier_confidence_level: The confidence level of the outlier, which
    is between ``0`` and ``1``. For example, the confidence level of
    ``0.001`` means that the outliers are in the 1% area of the both ends
    of the tails of the normal distribution. When this value is zero, no
    outlier will be detected and removed. A larger level will flag more
    points as outlier.
:type confidence_level: float

:return: Returns two arrays:
    * ``cleaned_smaples``: an array copied from ``samples``, but the
      outliers are converted to ``numpy.nan``.
    * ``outlier_indices``: a boolean array of the same shape as ``samples``
      where the flagged outliers are set to True.
: rtype: tuple (numpy.ndarray)
</pre> 
<p class="definition">Definition at line <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00031">31</a> of file <a class="el" href="trace__estimator__plot__utilities_8py_source.html">trace_estimator_plot_utilities.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        outlier_confidence_level):</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="stringliteral">    Flags the outlier samples and sets them to nan. The outlier is defined</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="stringliteral">    by those sample points that are outside of the confidence region</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="stringliteral">    defined by a confidence level.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="stringliteral">    :param samples: 2D array of size ``(max_num_samples, num_inquiry)``. Each</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="stringliteral">        column is the set of all samples for an inquiry. Some of these samples</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="stringliteral">        might be nan, because, often, the convergence is achieved sooner than</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="stringliteral">        ``max_num_samples``, hence, with the fewer number of processed rows,</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="stringliteral">        the remaining elements in a row remain nan.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="stringliteral">    :type: numpy.ndarray</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="stringliteral">    :param samples_processed_order: Due to parallel processing, the rows of the</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral">        ``samples`` array are not processed sequentially. This 1D array of size</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral">        ``max_num_samples`` keeps the record of the process order of the rows</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="stringliteral">        of ``samples``.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="stringliteral">    :type samples_process_order: numpy.ndarray</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="stringliteral">    :param num_samples_used: 1D array of size ``num_inquiry``. The j-th</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="stringliteral">        element is the number of valid (non-nan) rows of the j-th column of</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="stringliteral">        ``samples``. Thus, it indicates how many samples exists for the j-th</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="stringliteral">        inquiry out of the max number of samples.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="stringliteral">    :type num_samples_used: numpy.ndarray</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">    :param outlier_confidence_level: The confidence level of the outlier, which</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="stringliteral">        is between ``0`` and ``1``. For example, the confidence level of</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="stringliteral">        ``0.001`` means that the outliers are in the 1% area of the both ends</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="stringliteral">        of the tails of the normal distribution. When this value is zero, no</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="stringliteral">        outlier will be detected and removed. A larger level will flag more</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="stringliteral">        points as outlier.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">    :type confidence_level: float</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">    :return: Returns two arrays:</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">        * ``cleaned_smaples``: an array copied from ``samples``, but the</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral">          outliers are converted to ``numpy.nan``.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">        * ``outlier_indices``: a boolean array of the same shape as ``samples``</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral">          where the flagged outliers are set to True.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral">    : rtype: tuple (numpy.ndarray)</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    num_inquiries = samples.shape[1]</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    outlier_indices = numpy.zeros(samples.shape, dtype=bool)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    cleaned_samples = numpy.copy(samples)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment"># Quantile of the region that is &quot;not&quot; considered as outlier</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    non_outlier_confidence_level = 1.0 - outlier_confidence_level</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    outlier_quantile = \</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        numpy.sqrt(2) * scipy.special.erfinv(non_outlier_confidence_level)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(num_inquiries):</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        sample_indices = samples_processed_order[:num_samples_used[j]]</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        valid_samples = samples[sample_indices, j]</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment"># Mean and std of the j-th column of samples</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        mean = numpy.nanmean(valid_samples)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        std = numpy.nanstd(valid_samples)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment"># Find those samples outside of the confidence region</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        difference = numpy.abs(samples[:, j] - mean)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        outlier_indices[:, j] = \</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            (difference &gt; outlier_quantile * std).astype(bool)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment"># Remove outliers</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        cleaned_samples[outlier_indices[:, j], j] = numpy.nan</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span> cleaned_samples, outlier_indices</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"># =============================</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"># compute cumulative statistics</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"># =============================</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00512">imate._trace_estimator.trace_estimator_plot_utilities.plot_convergence()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a4856b82b9c4a9d17e5c2be1c505a010d_icgraph.png" border="0" usemap="#anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a4856b82b9c4a9d17e5c2be1c505a010d_icgraph" alt=""/></div>
<map name="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a4856b82b9c4a9d17e5c2be1c505a010d_icgraph" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a4856b82b9c4a9d17e5c2be1c505a010d_icgraph">
<area shape="rect" title=" " alt="" coords="2631,300,2817,356"/>
<area shape="rect" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991" title=" " alt="" coords="2396,300,2583,356"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1__hutchinson__method.html#a62c0bc37cf02ed8dddf9d15fd56112ed" title=" " alt="" coords="2159,307,2348,349"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1traceinv.html#af09d9b0af1471fa625846f791debb269" title=" " alt="" coords="1911,315,2111,341"/>
<area shape="rect" href="namespaceimate_1_1schatten_1_1schatten.html#addd398048ffe6f31c8401438d3ab708e" title=" " alt="" coords="1647,315,1863,341"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ac280d2903b95eebb4f52d53a39f9814b" title=" " alt="" coords="1409,300,1599,356"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a413ec50ad36453760a7640af0d254aa5" title=" " alt="" coords="1172,256,1361,312"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#af4dff8144fb18580899069269f2f57eb" title=" " alt="" coords="1172,337,1361,407"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ae34c18fb577fc57bcf0f70cc0a86d073" title=" " alt="" coords="935,260,1124,316"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ab536b71b179a86e3c869f7b1f5e1a113" title=" " alt="" coords="935,180,1124,236"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#aa0fab44823eefba8f131db3cac2b657f" title=" " alt="" coords="628,5,829,61"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#ab6500d8ed781a3dc971e9c06e856b58f" title=" " alt="" coords="299,107,499,163"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a9cbdbcf5477fa0f629bfc90b96124d47" title=" " alt="" coords="299,27,499,83"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__monomial__basis__functions__method_1_1MonomialBasisFunctionsMethod.html#a805c6eb66a8397506be953f71f1f0266" title=" " alt="" coords="571,355,887,426"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__exact__method_1_1ExactMethod.html#ab3fca349a29a103f4496e1c8593fb2a0" title=" " alt="" coords="601,187,857,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__logdet_1_1InterpolateLogdet.html#af80d3805ea6303c00baf4f1e92d79652" title=" " alt="" coords="302,253,495,294"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__trace_1_1InterpolateTrace.html#a38158704798314a5ea2a5d3f9fb2a226" title=" " alt="" coords="306,318,491,359"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a730f165dfcdbdf27fc062b383ee6845a" title=" " alt="" coords="5,114,227,155"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a8d73f3cded7d501f9563ce09ff9951e4" title=" " alt="" coords="275,187,523,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a8518f8ac4e73004e17323152e1dbbd27" title=" " alt="" coords="935,344,1124,400"/>
</map>
</div>

</div>
</div>
<a id="a5b5b11b077873546cc4bd81e9d38c991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b5b11b077873546cc4bd81e9d38c991">&#9670;&nbsp;</a></span>plot_convergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def imate._trace_estimator.trace_estimator_plot_utilities.plot_convergence </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Plots samples, cumulative mean, absolute and relative error.

:param info: A dictionary of all output info.
:type: dict
</pre> 
<p class="definition">Definition at line <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00512">512</a> of file <a class="el" href="trace__estimator__plot__utilities_8py_source.html">trace_estimator_plot_utilities.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991">plot_convergence</a>(info):</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="stringliteral">    Plots samples, cumulative mean, absolute and relative error.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="stringliteral">    :param info: A dictionary of all output info.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="stringliteral">    :type: dict</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> plot_modules_exist:</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">raise</span> ImportError(<span class="stringliteral">&#39;Cannot import modules for plotting. Either &#39;</span> +</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                          <span class="stringliteral">&#39;install &quot;matplotlib&quot; and &quot;seaborn&quot; packages, &#39;</span> +</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                          <span class="stringliteral">&#39;or set &quot;plot=False&quot;.&#39;</span>)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment"># Load plot settings</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="namespaceimate_1_1__utilities_1_1plot__utilities.html#ac5be3859295616ee4d82fdcaab5faedd">load_plot_settings</a>()</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">except</span> ImportError:</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">raise</span> ImportError(<span class="stringliteral">&#39;Cannot import modules for plotting. Either &#39;</span> +</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                          <span class="stringliteral">&#39;install &quot;matplotlib&quot; and &quot;seaborn&quot; packages, &#39;</span> +</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                          <span class="stringliteral">&#39;or set &quot;plot=False&quot;.&#39;</span>)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment"># Extract variables from info dictionary</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    num_inquiries = info[<span class="stringliteral">&#39;matrix&#39;</span>][<span class="stringliteral">&#39;num_inquiries&#39;</span>]</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    error_atol = info[<span class="stringliteral">&#39;error&#39;</span>][<span class="stringliteral">&#39;error_atol&#39;</span>]</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    error_rtol = info[<span class="stringliteral">&#39;error&#39;</span>][<span class="stringliteral">&#39;error_rtol&#39;</span>] * 100.0</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    confidence_level = info[<span class="stringliteral">&#39;error&#39;</span>][<span class="stringliteral">&#39;confidence_level&#39;</span>]</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    num_samples_used = info[<span class="stringliteral">&#39;convergence&#39;</span>][<span class="stringliteral">&#39;num_samples_used&#39;</span>]</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    min_num_samples = info[<span class="stringliteral">&#39;convergence&#39;</span>][<span class="stringliteral">&#39;min_num_samples&#39;</span>]</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    max_num_samples = info[<span class="stringliteral">&#39;convergence&#39;</span>][<span class="stringliteral">&#39;max_num_samples&#39;</span>]</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    converged = info[<span class="stringliteral">&#39;convergence&#39;</span>][<span class="stringliteral">&#39;converged&#39;</span>]</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    samples = info[<span class="stringliteral">&#39;convergence&#39;</span>][<span class="stringliteral">&#39;samples&#39;</span>]</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    samples_processed_order = info[<span class="stringliteral">&#39;convergence&#39;</span>][<span class="stringliteral">&#39;samples_processed_order&#39;</span>]</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment"># Convert scalars to arrays for easier indexing. When num_inquiries is 1,</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment"># all variables below are scalars. These are converted to arrays of size 1.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> numpy.isscalar(num_samples_used):</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        num_samples_used = numpy.array([num_samples_used])</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">if</span> numpy.isscalar(converged):</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        converged = numpy.array([converged])</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> samples.ndim == 1:</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        samples = numpy.array([samples]).T</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> numpy.isscalar(converged):</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        converged = numpy.array([converged])</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment"># Remove outliers from samples</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    outlier_confidence_level = 0.001</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    cleaned_samples, outlier_indices = <a class="code" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a4856b82b9c4a9d17e5c2be1c505a010d">_remove_outliers</a>(</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            samples,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            samples_processed_order,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            num_samples_used,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            outlier_confidence_level)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment"># Compute cumulative mean and errors (as sample indices progress)</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    cumulative_mean, cumulative_abs_error, cumulative_rel_error = \</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ab9d29de8d95a73fda97ac3868aadddfc">_compute_cumulative_statistics</a>(</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                cleaned_samples,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                samples_processed_order,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                num_samples_used,</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                confidence_level)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment"># Different plots depending on number of inquiries</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> num_inquiries == 1:</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment"># Plot both samples (on left axis) and relative error (on right axis)</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        fig, ax = plt.subplots(ncols=2, figsize=(11, 5))</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <a class="code" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ad7047cd3e950939f55c0351853e756e1">_plot_samples</a>(ax[0], cleaned_samples, samples_processed_order,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                      num_samples_used, confidence_level, cumulative_mean,</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                      cumulative_abs_error)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ac297a0e6e32b51a8fc6308b93c724869">_plot_error</a>(ax[1], num_samples_used, min_num_samples, max_num_samples,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                    error_atol, error_rtol, converged, cumulative_abs_error,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                    cumulative_rel_error)</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment"># Plot only relative error (one axis) but for all inquiries</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        fig, ax = plt.subplots(ncols=1, figsize=(8.3, 5))</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ac297a0e6e32b51a8fc6308b93c724869">_plot_error</a>(ax, num_samples_used, min_num_samples, max_num_samples,</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    error_atol, error_rtol, converged, cumulative_abs_error,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    cumulative_rel_error)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    plt.tight_layout()</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment"># Check if the graphical backend exists</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> matplotlib.get_backend() != <span class="stringliteral">&#39;agg&#39;</span>:</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        plt.show()</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment"># write the plot as SVG file in the current working directory</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="namespaceimate_1_1__utilities_1_1plot__utilities.html#a16effb74c6816ea6e0efbd6cbd19a494">save_plot</a>(plt, <span class="stringliteral">&#39;Convergence&#39;</span>, transparent_background=<span class="keyword">True</span>)</div>
<div class="ttc" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_html_a4856b82b9c4a9d17e5c2be1c505a010d"><div class="ttname"><a href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a4856b82b9c4a9d17e5c2be1c505a010d">imate._trace_estimator.trace_estimator_plot_utilities._remove_outliers</a></div><div class="ttdeci">def _remove_outliers(samples, samples_processed_order, num_samples_used, outlier_confidence_level)</div><div class="ttdef"><b>Definition:</b> <a href="trace__estimator__plot__utilities_8py_source.html#l00031">trace_estimator_plot_utilities.py:35</a></div></div>
<div class="ttc" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_html_a5b5b11b077873546cc4bd81e9d38c991"><div class="ttname"><a href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991">imate._trace_estimator.trace_estimator_plot_utilities.plot_convergence</a></div><div class="ttdeci">def plot_convergence(info)</div><div class="ttdef"><b>Definition:</b> <a href="trace__estimator__plot__utilities_8py_source.html#l00512">trace_estimator_plot_utilities.py:512</a></div></div>
<div class="ttc" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_html_ab9d29de8d95a73fda97ac3868aadddfc"><div class="ttname"><a href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ab9d29de8d95a73fda97ac3868aadddfc">imate._trace_estimator.trace_estimator_plot_utilities._compute_cumulative_statistics</a></div><div class="ttdeci">def _compute_cumulative_statistics(samples, samples_processed_order, num_samples_used, confidence_level)</div><div class="ttdef"><b>Definition:</b> <a href="trace__estimator__plot__utilities_8py_source.html#l00109">trace_estimator_plot_utilities.py:113</a></div></div>
<div class="ttc" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_html_ac297a0e6e32b51a8fc6308b93c724869"><div class="ttname"><a href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ac297a0e6e32b51a8fc6308b93c724869">imate._trace_estimator.trace_estimator_plot_utilities._plot_error</a></div><div class="ttdeci">def _plot_error(ax, num_samples_used, min_num_samples, max_num_samples, error_atol, error_rtol, converged, cumulative_abs_error, cumulative_rel_error)</div><div class="ttdef"><b>Definition:</b> <a href="trace__estimator__plot__utilities_8py_source.html#l00306">trace_estimator_plot_utilities.py:315</a></div></div>
<div class="ttc" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_html_ad7047cd3e950939f55c0351853e756e1"><div class="ttname"><a href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ad7047cd3e950939f55c0351853e756e1">imate._trace_estimator.trace_estimator_plot_utilities._plot_samples</a></div><div class="ttdeci">def _plot_samples(ax, samples, samples_processed_order, num_samples_used, confidence_level, cumulative_mean, cumulative_abs_error)</div><div class="ttdef"><b>Definition:</b> <a href="trace__estimator__plot__utilities_8py_source.html#l00199">trace_estimator_plot_utilities.py:206</a></div></div>
<div class="ttc" id="anamespaceimate_1_1__utilities_1_1plot__utilities_html_a16effb74c6816ea6e0efbd6cbd19a494"><div class="ttname"><a href="namespaceimate_1_1__utilities_1_1plot__utilities.html#a16effb74c6816ea6e0efbd6cbd19a494">imate._utilities.plot_utilities.save_plot</a></div><div class="ttdeci">def save_plot(plt, filename, transparent_background=True, pdf=True, bbox_extra_artists=None, verbose=False)</div><div class="ttdef"><b>Definition:</b> <a href="plot__utilities_8py_source.html#l00104">plot_utilities.py:110</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00113">imate._trace_estimator.trace_estimator_plot_utilities._compute_cumulative_statistics()</a>, <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00315">imate._trace_estimator.trace_estimator_plot_utilities._plot_error()</a>, <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00206">imate._trace_estimator.trace_estimator_plot_utilities._plot_samples()</a>, <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00035">imate._trace_estimator.trace_estimator_plot_utilities._remove_outliers()</a>, <a class="el" href="plot__utilities_8py_source.html#l00064">imate._utilities.plot_utilities.load_plot_settings()</a>, and <a class="el" href="plot__utilities_8py_source.html#l00110">imate._utilities.plot_utilities.save_plot()</a>.</p>

<p class="reference">Referenced by <a class="el" href="__hutchinson__method_8pyx_source.html#l00055">imate.traceinv._hutchinson_method.hutchinson_method()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a5b5b11b077873546cc4bd81e9d38c991_cgraph.png" border="0" usemap="#anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a5b5b11b077873546cc4bd81e9d38c991_cgraph" alt=""/></div>
<map name="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a5b5b11b077873546cc4bd81e9d38c991_cgraph" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a5b5b11b077873546cc4bd81e9d38c991_cgraph">
<area shape="rect" title=" " alt="" coords="5,184,192,240"/>
<area shape="rect" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ab9d29de8d95a73fda97ac3868aadddfc" title=" " alt="" coords="240,5,449,61"/>
<area shape="rect" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ac297a0e6e32b51a8fc6308b93c724869" title=" " alt="" coords="251,85,438,141"/>
<area shape="rect" href="namespaceimate_1_1__utilities_1_1plot__utilities.html#ac5be3859295616ee4d82fdcaab5faedd" title=" " alt="" coords="497,151,628,207"/>
<area shape="rect" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#ad7047cd3e950939f55c0351853e756e1" title=" " alt="" coords="251,216,438,272"/>
<area shape="rect" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a4856b82b9c4a9d17e5c2be1c505a010d" title=" " alt="" coords="251,296,438,352"/>
<area shape="rect" href="namespaceimate_1_1__utilities_1_1plot__utilities.html#a16effb74c6816ea6e0efbd6cbd19a494" title=" " alt="" coords="279,377,410,418"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a5b5b11b077873546cc4bd81e9d38c991_icgraph.png" border="0" usemap="#anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a5b5b11b077873546cc4bd81e9d38c991_icgraph" alt=""/></div>
<map name="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a5b5b11b077873546cc4bd81e9d38c991_icgraph" id="anamespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities_a5b5b11b077873546cc4bd81e9d38c991_icgraph">
<area shape="rect" title=" " alt="" coords="2396,300,2583,356"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1__hutchinson__method.html#a62c0bc37cf02ed8dddf9d15fd56112ed" title=" " alt="" coords="2159,307,2348,349"/>
<area shape="rect" href="namespaceimate_1_1traceinv_1_1traceinv.html#af09d9b0af1471fa625846f791debb269" title=" " alt="" coords="1911,315,2111,341"/>
<area shape="rect" href="namespaceimate_1_1schatten_1_1schatten.html#addd398048ffe6f31c8401438d3ab708e" title=" " alt="" coords="1647,315,1863,341"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ac280d2903b95eebb4f52d53a39f9814b" title=" " alt="" coords="1409,300,1599,356"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a413ec50ad36453760a7640af0d254aa5" title=" " alt="" coords="1172,256,1361,312"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#af4dff8144fb18580899069269f2f57eb" title=" " alt="" coords="1172,337,1361,407"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ae34c18fb577fc57bcf0f70cc0a86d073" title=" " alt="" coords="935,260,1124,316"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#ab536b71b179a86e3c869f7b1f5e1a113" title=" " alt="" coords="935,180,1124,236"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#aa0fab44823eefba8f131db3cac2b657f" title=" " alt="" coords="628,5,829,61"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#ab6500d8ed781a3dc971e9c06e856b58f" title=" " alt="" coords="299,107,499,163"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a9cbdbcf5477fa0f629bfc90b96124d47" title=" " alt="" coords="299,27,499,83"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__monomial__basis__functions__method_1_1MonomialBasisFunctionsMethod.html#a805c6eb66a8397506be953f71f1f0266" title=" " alt="" coords="571,355,887,426"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__exact__method_1_1ExactMethod.html#ab3fca349a29a103f4496e1c8593fb2a0" title=" " alt="" coords="601,187,857,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__logdet_1_1InterpolateLogdet.html#af80d3805ea6303c00baf4f1e92d79652" title=" " alt="" coords="302,253,495,294"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__trace_1_1InterpolateTrace.html#a38158704798314a5ea2a5d3f9fb2a226" title=" " alt="" coords="306,318,491,359"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a730f165dfcdbdf27fc062b383ee6845a" title=" " alt="" coords="5,114,227,155"/>
<area shape="rect" href="classimate_1_1interpolator_1_1interpolate__schatten_1_1InterpolateSchatten.html#a8d73f3cded7d501f9563ce09ff9951e4" title=" " alt="" coords="275,187,523,229"/>
<area shape="rect" href="classimate_1_1interpolator_1_1__interpolant__base_1_1InterpolantBase.html#a8518f8ac4e73004e17323152e1dbbd27" title=" " alt="" coords="935,344,1124,400"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a980131643214ef893ac370c8923b67c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a980131643214ef893ac370c8923b67c6">&#9670;&nbsp;</a></span>__all__</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list imate._trace_estimator.trace_estimator_plot_utilities.__all__ = ['<a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html#a5b5b11b077873546cc4bd81e9d38c991">plot_convergence</a>']</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00024">24</a> of file <a class="el" href="trace__estimator__plot__utilities_8py_source.html">trace_estimator_plot_utilities.py</a>.</p>

</div>
</div>
<a id="a5493bc208abc22214cc40ed200d4be3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5493bc208abc22214cc40ed200d4be3b">&#9670;&nbsp;</a></span>plot_modules_exist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool imate._trace_estimator.trace_estimator_plot_utilities.plot_modules_exist = True</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trace__estimator__plot__utilities_8py_source.html#l00020">20</a> of file <a class="el" href="trace__estimator__plot__utilities_8py_source.html">trace_estimator_plot_utilities.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceimate.html">imate</a></li><li class="navelem"><a class="el" href="namespaceimate_1_1__trace__estimator.html">_trace_estimator</a></li><li class="navelem"><a class="el" href="namespaceimate_1_1__trace__estimator_1_1trace__estimator__plot__utilities.html">trace_estimator_plot_utilities</a></li>
    <li class="footer">Generated on Thu Sep 1 2022 16:13:23 for imate by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>

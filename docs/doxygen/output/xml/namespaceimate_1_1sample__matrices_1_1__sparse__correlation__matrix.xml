<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix" kind="namespace" language="Python">
    <compoundname>imate::sample_matrices::_sparse_correlation_matrix</compoundname>
      <sectiondef kind="var">
      <memberdef kind="variable" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a7ca42de708046d2c85bdea3a4cc63e8f" prot="private" static="no" mutable="no">
        <type>list</type>
        <definition>list imate::sample_matrices::_sparse_correlation_matrix.__all__</definition>
        <argsstring></argsstring>
        <name>__all__</name>
        <initializer>=  [&apos;<ref refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a83b3a16cded854e41425d2550d137d95" kindref="member">sparse_correlation_matrix</ref>&apos;]</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="30" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="30" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a17b50a7e253165ef67ec21637506bc86" prot="public" static="no" mutable="no">
        <type></type>
        <definition>imate::sample_matrices::_sparse_correlation_matrix.thread_data</definition>
        <argsstring></argsstring>
        <name>thread_data</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="130" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="130" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1af7d9682bb1a7c5b410e9c10a126d3a56" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int imate::sample_matrices::_sparse_correlation_matrix::percent_update</definition>
        <argsstring></argsstring>
        <name>percent_update</name>
        <initializer>=  20</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="138" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="138" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a60806b66a4a6944d461cb3bd9604e841" prot="public" static="no" mutable="no">
        <type></type>
        <definition>int imate::sample_matrices::_sparse_correlation_matrix::chunk_size</definition>
        <argsstring></argsstring>
        <name>chunk_size</name>
        <initializer>=  1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="160" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="160" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1abf97d69347ee97bcd481a3e5fc952dc5" prot="public" static="no" mutable="no">
        <type></type>
        <definition>imate::sample_matrices::_sparse_correlation_matrix.matrix_size</definition>
        <argsstring></argsstring>
        <name>matrix_size</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="169" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="169" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a6150f88eff2b0bde96fa3e09b2abfcd3" prot="public" static="no" mutable="no">
        <type></type>
        <definition>imate::sample_matrices::_sparse_correlation_matrix.schedule</definition>
        <argsstring></argsstring>
        <name>schedule</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="169" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="169" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a0cfa2e07134719c8e798deef9fbfea08" prot="public" static="no" mutable="no">
        <type></type>
        <definition>imate::sample_matrices::_sparse_correlation_matrix.chunksize</definition>
        <argsstring></argsstring>
        <name>chunksize</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="169" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="169" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a1d140c3362c16ea2f3a3188521d70cd5" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int imate::sample_matrices::_sparse_correlation_matrix.progress</definition>
        <argsstring></argsstring>
        <name>progress</name>
        <initializer>=  <ref refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1af7d9682bb1a7c5b410e9c10a126d3a56" kindref="member">percent_update</ref> * counter[0] // \</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="237" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="237" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1aed6b3a6512bc03277e77310fa5ccde00" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>def</type>
        <definition>def imate.sample_matrices._sparse_correlation_matrix._ball_radius</definition>
        <argsstring>(volume, dimension)</argsstring>
        <name>_ball_radius</name>
        <param>
          <type>volume</type>
          <defname>volume</defname>
        </param>
        <param>
          <type>dimension</type>
          <defname>dimension</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Computes the radius of n-ball at dimension n, given its volume.

:param volume: Volume of n-ball
:type volume: double

:param dimension: Dimension of embedding space
:type dimension: int

:return: radius of n-ball
:rtype: double
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="253" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="253" bodyend="290"/>
        <referencedby refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1ad3eb76f51fd5dd38e4aa3222ac1c93a5" compoundref="__sparse__correlation__matrix_8pyx" startline="297" endline="410">imate.sample_matrices._sparse_correlation_matrix._estimate_kernel_threshold</referencedby>
        <referencedby refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a46ec734668902458e231252e57796aaa" compoundref="__sparse__correlation__matrix_8pyx" startline="414" endline="451">imate.sample_matrices._sparse_correlation_matrix._estimate_max_nnz</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1ad3eb76f51fd5dd38e4aa3222ac1c93a5" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>def</type>
        <definition>def imate.sample_matrices._sparse_correlation_matrix._estimate_kernel_threshold</definition>
        <argsstring>(matrix_size, dimension, density, scale, kernel, kernel_param)</argsstring>
        <name>_estimate_kernel_threshold</name>
        <param>
          <type><ref refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1abf97d69347ee97bcd481a3e5fc952dc5" kindref="member">matrix_size</ref></type>
          <defname>matrix_size</defname>
        </param>
        <param>
          <type>dimension</type>
          <defname>dimension</defname>
        </param>
        <param>
          <type>density</type>
          <defname>density</defname>
        </param>
        <param>
          <type>scale</type>
          <defname>scale</defname>
        </param>
        <param>
          <type>kernel</type>
          <defname>kernel</defname>
        </param>
        <param>
          <type>kernel_param</type>
          <defname>kernel_param</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Estimates the kernel&apos;s tapering threshold to sparsify a dense matrix into a
sparse matrix with the requested density.

Here is how density :math:`\\rho` is related to the kernel_threshold
:math:`\\tau`:

.. math::

    a = \\rho n = \\mathrm{Vol}_{d}(r/l),
    \\tau = k(r),

where:

    * :math:`n` is the number of points in the unit hypercube, also it is
      the matrix size.
    * :math:`d` is the dimension of space.
    * :math:`\\mathrm{Vol}_{d}(r/l)` is the volume of d-ball of radius
      :math:`r/l`.
    * :math:`l = 1/(\\sqrt[d]{n} - 1)` is the grid size along each axis,
      assuming the points are places on an equi-distanced structured grid.
    * :math:`k` is the Matern correlation function.
    * :math:`a` is the adjacency of a point, which is the number of
      the neighbor points that are correlated to a point.
    * :math:`\\rho` is the sparse matrix density (input to this function).
    * :math:`\\tau` is the kernel threshold (output of this function).

The adjacency :math:`a` is the number of points on an integer lattice
and inside a d-ball. This quantity can be approximated by the volume of a
d-ball, see for instance
`Gauss circle problem&lt;https://en.wikipedia.org/wiki/Gauss_circle_problem&gt;`_
 in 2D.

A non-zero kernel threshold is used to sparsify a matrix by tapering its
correlation function. However, if the kernel threshold is too large, some
elements of the correlation matrix will not be correlated to any other
neighbor point. This leads to a correlation matrix with some rows that have
only one non-zero element equal to one on the diagonal and zero elsewhere.
Essentially, if all points loose their correlation to a neighbor, the
matrix becomes identity.

This function checks if a set of parameters to form a sparse matrix could
lead to this issue. The correlation matrix in this module is formed by the
mutual correlation between spatial set of points in the unit hypercube. We
assume each point is surrounded by a sphere of the radius of the kernel
threshold. If this radius is large enough, then the sphere of all points
intersect. If the criteria is not met, this function raises ``ValueError``.

:param matrix_size: The size of the square matrix. This is also the number
    of points used to construct the correlation matrix.
:type matrix_size: int

:param dimension: The dimension of the space of points used to construct
    the correlation matrix.
:type dimension: int

:param sparse_density: The desired density of the sparse matrix. Note that
    the actual density of the generated matrix will not be exactly equal to
    this value. If the matrix size is large, this value is close to the
    actual matrix density.
:type sparse_density: int

:param scale: A parameter of correlation function that scales
    distance.
:type scale: float

:param nu: The parameter :math:`\\nu` of Matern correlation kernel.
:type nu: float

:return: Kernel threshold level
:rtype: double
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="291" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="297" bodyend="410"/>
        <references refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1aed6b3a6512bc03277e77310fa5ccde00" compoundref="__sparse__correlation__matrix_8pyx" startline="253" endline="290">imate.sample_matrices._sparse_correlation_matrix._ball_radius</references>
        <references refid="namespaceimate_1_1sample__matrices_1_1__kernels_1a72b54b22ba340e9e52a32f60c222bc77" compoundref="__kernels_8pyx" startline="48">imate.sample_matrices._kernels.kernel_function</references>
        <referencedby refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a83b3a16cded854e41425d2550d137d95" compoundref="__sparse__correlation__matrix_8pyx" startline="460" endline="663">imate.sample_matrices._sparse_correlation_matrix.sparse_correlation_matrix</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a46ec734668902458e231252e57796aaa" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>def</type>
        <definition>def imate.sample_matrices._sparse_correlation_matrix._estimate_max_nnz</definition>
        <argsstring>(matrix_size, dimension, density)</argsstring>
        <name>_estimate_max_nnz</name>
        <param>
          <type><ref refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1abf97d69347ee97bcd481a3e5fc952dc5" kindref="member">matrix_size</ref></type>
          <defname>matrix_size</defname>
        </param>
        <param>
          <type>dimension</type>
          <defname>dimension</defname>
        </param>
        <param>
          <type>density</type>
          <defname>density</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Estimates the maximum number of nnz needed to store the indices and data of
the generated sparse matrix. Before the generation of the sparse matrix,
its nnz (number of non-zero elements) are not known. Thus, this function
only guesses this value based on its density.

:param matrix_size: The size of the square matrix. This is also the number
    of points used to construct the correlation matrix.
:type matrix_size: int

:param dimension: The dimension of the space of points used to construct
    the correlation matrix.
:type dimension: int

:param sparse_density: The desired density of the sparse matrix. Note that
    the actual density of the generated matrix will not be exactly equal to
    this value. If the matrix size is large, this value is close to the
    actual matrix density.
:type sparse_density: int

:return: maximum non-zero elements of sparse array
:rtype: double
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="411" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="414" bodyend="451"/>
        <references refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1aed6b3a6512bc03277e77310fa5ccde00" compoundref="__sparse__correlation__matrix_8pyx" startline="253" endline="290">imate.sample_matrices._sparse_correlation_matrix._ball_radius</references>
        <referencedby refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a83b3a16cded854e41425d2550d137d95" compoundref="__sparse__correlation__matrix_8pyx" startline="460" endline="663">imate.sample_matrices._sparse_correlation_matrix.sparse_correlation_matrix</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a83b3a16cded854e41425d2550d137d95" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>def</type>
        <definition>def imate.sample_matrices._sparse_correlation_matrix.sparse_correlation_matrix</definition>
        <argsstring>(coords, scale=0.1, kernel=&apos;exponential&apos;, kernel_param=None, density=0.001, format=r &apos;csr&apos;, dtype=r &apos;float64&apos;, verbose=False)</argsstring>
        <name>sparse_correlation_matrix</name>
        <param>
          <type>coords</type>
          <defname>coords</defname>
        </param>
        <param>
          <type>scale</type>
          <defname>scale</defname>
          <defval>0.1</defval>
        </param>
        <param>
          <type>kernel</type>
          <defname>kernel</defname>
          <defval>&apos;exponential&apos;</defval>
        </param>
        <param>
          <type>kernel_param</type>
          <defname>kernel_param</defname>
          <defval>None</defval>
        </param>
        <param>
          <type>density</type>
          <defname>density</defname>
          <defval>0.001</defval>
        </param>
        <param>
          <type>format</type>
          <defname>format</defname>
          <defval>r &apos;csr&apos;</defval>
        </param>
        <param>
          <type>dtype</type>
          <defname>dtype</defname>
          <defval>r &apos;float64&apos;</defval>
        </param>
        <param>
          <type>verbose</type>
          <defname>verbose</defname>
          <defval>False</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Generates either a sparse correlation matrix.

.. note::

    If the ``kernel_threshold`` is large, it causes:

        * The correlation matrix :math:`\\mathbf{K}` will not be
          positive-definite.
        * The function :math:`\\mathrm{trace}\\left((\\mathbf{K}+t
          \\mathbf{I})^{-1}\\right)` produces unwanted oscillations.

:param coords: 2D array of the coordinates of the set of points. The first
    index of the array is the point Ids and its size determines the size of
    the correlation matrix. The second index of the array corresponds to
    the dimension of the spatial points.
:type coords: numpy.ndarray

:param scale: A parameter of correlation function that scales
    distance.
:type scale: float

:param nu: The parameter :math:`\\nu` of Matern correlation kernel.
:type nu: float

:param density: The desired density of the non-zero elements of the sparse
    matrix. Note that the actual density of the generated matrix may not be
    exactly equal to this value. If the matrix size is large, this value is
    close to the actual matrix density.
:type sparse_density: int

:param verbose: If ``True``, prints some information during the process.
:type verbose: bool

:return: Correlation matrix. If ``coords`` is ``n*m`` array, the
    correlation ``K`` is ``n*n`` matrix.
:rtype: numpy.ndarray or scipy.sparse array

.. warning::
    ``kernel_threshold`` should be large enough so that the correlation
    matrix is not shrunk to identity. If such case happens, this function
    raises a *ValueError* exception.

    In addition, ``kernel_threshold`` should be small enough to not
    eradicate its positive-definiteness. This is not checked by this
    function and the user should be aware of it.
</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="452" column="1" bodyfile="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" bodystart="460" bodyend="663"/>
        <references refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1ad3eb76f51fd5dd38e4aa3222ac1c93a5" compoundref="__sparse__correlation__matrix_8pyx" startline="297" endline="410">imate.sample_matrices._sparse_correlation_matrix._estimate_kernel_threshold</references>
        <references refid="namespaceimate_1_1sample__matrices_1_1__sparse__correlation__matrix_1a46ec734668902458e231252e57796aaa" compoundref="__sparse__correlation__matrix_8pyx" startline="414" endline="451">imate.sample_matrices._sparse_correlation_matrix._estimate_max_nnz</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <location file="/home/sia/work/ADCP/Noise-Estimation/code/imate/imate/sample_matrices/_sparse_correlation_matrix.pyx" line="1" column="1"/>
  </compounddef>
</doxygen>

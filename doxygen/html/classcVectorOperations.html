<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>imate: cVectorOperations&lt; DataType &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "TeX/AMSfonts.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ameli/imate" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-imate-light.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">imate
   </div>
   <div id="projectbrief">C++/CUDA Reference</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classcVectorOperations.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classcVectorOperations-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">cVectorOperations&lt; DataType &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A static class for vector operations, similar to level-1 operations of the BLAS library. This class acts as a templated namespace, where all member methods are <em>public</em> and <em>static</em>.  
 <a href="classcVectorOperations.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="c__vector__operations_8h_source.html">c_vector_operations.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a492894cdc368a4f60b28aa15109cf9bc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcVectorOperations.html#a492894cdc368a4f60b28aa15109cf9bc">copy_vector</a> (const DataType *input_vector, const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size, DataType *output_vector)</td></tr>
<tr class="memdesc:a492894cdc368a4f60b28aa15109cf9bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies a vector to a new vector. Result is written in-place.  <a href="classcVectorOperations.html#a492894cdc368a4f60b28aa15109cf9bc">More...</a><br /></td></tr>
<tr class="separator:a492894cdc368a4f60b28aa15109cf9bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6627fe95659faa224dca2af1dab1fab3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcVectorOperations.html#a6627fe95659faa224dca2af1dab1fab3">copy_scaled_vector</a> (const DataType *input_vector, const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size, const DataType scale, DataType *output_vector)</td></tr>
<tr class="memdesc:a6627fe95659faa224dca2af1dab1fab3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scales a vector and stores to a new vector.  <a href="classcVectorOperations.html#a6627fe95659faa224dca2af1dab1fab3">More...</a><br /></td></tr>
<tr class="separator:a6627fe95659faa224dca2af1dab1fab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd28bd08f5a6b096d99a4a2f7d23e90"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcVectorOperations.html#a9bd28bd08f5a6b096d99a4a2f7d23e90">subtract_scaled_vector</a> (const DataType *input_vector, const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size, const DataType scale, DataType *output_vector)</td></tr>
<tr class="memdesc:a9bd28bd08f5a6b096d99a4a2f7d23e90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subtracts the scaled input vector from the output vector.  <a href="classcVectorOperations.html#a9bd28bd08f5a6b096d99a4a2f7d23e90">More...</a><br /></td></tr>
<tr class="separator:a9bd28bd08f5a6b096d99a4a2f7d23e90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b945baba573b4479e8095ca87f8b3f"><td class="memItemLeft" align="right" valign="top">static DataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcVectorOperations.html#ab8b945baba573b4479e8095ca87f8b3f">inner_product</a> (const DataType *vector1, const DataType *vector2, const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size)</td></tr>
<tr class="memdesc:ab8b945baba573b4479e8095ca87f8b3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes Euclidean inner product of two vectors.  <a href="classcVectorOperations.html#ab8b945baba573b4479e8095ca87f8b3f">More...</a><br /></td></tr>
<tr class="separator:ab8b945baba573b4479e8095ca87f8b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd0d2c941f9d3598f42026755cbc4709"><td class="memItemLeft" align="right" valign="top">static DataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709">euclidean_norm</a> (const DataType *vector, const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size)</td></tr>
<tr class="memdesc:abd0d2c941f9d3598f42026755cbc4709"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Euclidean norm of a 1D array.  <a href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709">More...</a><br /></td></tr>
<tr class="separator:abd0d2c941f9d3598f42026755cbc4709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0991d74cadf3a3969f0723dbff55dc9"><td class="memItemLeft" align="right" valign="top">static DataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcVectorOperations.html#ab0991d74cadf3a3969f0723dbff55dc9">normalize_vector_in_place</a> (DataType *vector, const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size)</td></tr>
<tr class="memdesc:ab0991d74cadf3a3969f0723dbff55dc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalizes a vector based on Euclidean 2-norm. The result is written in-place.  <a href="classcVectorOperations.html#ab0991d74cadf3a3969f0723dbff55dc9">More...</a><br /></td></tr>
<tr class="separator:ab0991d74cadf3a3969f0723dbff55dc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb0171f2644e3036907bbbddf47ce998"><td class="memItemLeft" align="right" valign="top">static DataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcVectorOperations.html#aeb0171f2644e3036907bbbddf47ce998">normalize_vector_and_copy</a> (const DataType *vector, const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size, DataType *output_vector)</td></tr>
<tr class="memdesc:aeb0171f2644e3036907bbbddf47ce998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalizes a vector based on Euclidean 2-norm. The result is written into another vector.  <a href="classcVectorOperations.html#aeb0171f2644e3036907bbbddf47ce998">More...</a><br /></td></tr>
<tr class="separator:aeb0171f2644e3036907bbbddf47ce998"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename DataType&gt;<br />
class cVectorOperations&lt; DataType &gt;</h3>

<p>A static class for vector operations, similar to level-1 operations of the BLAS library. This class acts as a templated namespace, where all member methods are <em>public</em> and <em>static</em>. </p>
<dl class="section see"><dt>See also</dt><dd>MatrixOperations </dd></dl>

<p class="definition">Definition at line <a class="el" href="c__vector__operations_8h_source.html#l00035">35</a> of file <a class="el" href="c__vector__operations_8h_source.html">c_vector_operations.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6627fe95659faa224dca2af1dab1fab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6627fe95659faa224dca2af1dab1fab3">&#9670;&nbsp;</a></span>copy_scaled_vector()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classcVectorOperations.html">cVectorOperations</a>&lt; DataType &gt;::copy_scaled_vector </td>
          <td>(</td>
          <td class="paramtype">const DataType *&#160;</td>
          <td class="paramname"><em>input_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a>&#160;</td>
          <td class="paramname"><em>vector_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DataType&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType *&#160;</td>
          <td class="paramname"><em>output_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scales a vector and stores to a new vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_vector</td><td>A 1D array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_size</td><td>Length of vector array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scale</td><td>Scale coefficient to the input vector. If this is equal to one, the function effectively becomes the same as <em>copy_vector</em>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output_vector</td><td>Output vector (written in place). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="c__vector__operations_8cpp_source.html#l00081">81</a> of file <a class="el" href="c__vector__operations_8cpp_source.html">c_vector_operations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">    #if (USE_CBLAS == 1)</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// Using OpenBlas</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">int</span> incx = 1;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">int</span> incy = 1;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    cblas_interface::xcopy(vector_size, input_vector, incx, output_vector,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                           incy);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    cblas_interface::xscal(vector_size, scale, output_vector, incy); </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Not using OpenBlas</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=0; i &lt; vector_size; ++i)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        output_vector[i] = scale * input_vector[i];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="ttc" id="atypes_8h_html_a4918759cb64dcead17269b3613b27d25"><div class="ttname"><a href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a></div><div class="ttdeci">int LongIndexType</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00060">types.h:60</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="c__lanczos__tridiagonalization_8cpp_source.html#l00117">c_lanczos_tridiagonalization()</a>, and <a class="el" href="c__vector__operations_8cpp_source.html#l00389">cVectorOperations&lt; DataType &gt;::normalize_vector_and_copy()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_a6627fe95659faa224dca2af1dab1fab3_icgraph.png" border="0" usemap="#aclasscVectorOperations_a6627fe95659faa224dca2af1dab1fab3_icgraph" alt=""/></div>
<map name="aclasscVectorOperations_a6627fe95659faa224dca2af1dab1fab3_icgraph" id="aclasscVectorOperations_a6627fe95659faa224dca2af1dab1fab3_icgraph">
<area shape="rect" title="Scales a vector and stores to a new vector." alt="" coords="923,25,1073,66"/>
<area shape="rect" href="c__lanczos__tridiagonalization_8cpp.html#a88831f1a1ba564b198f446a7c8a8d5ef" title="Tri&#45;diagonalizes matrix A to T using the start vector v. is the Lanczos degree, which will be the siz..." alt="" coords="405,5,611,32"/>
<area shape="rect" href="classcVectorOperations.html#aeb0171f2644e3036907bbbddf47ce998" title="Normalizes a vector based on Euclidean 2&#45;norm. The result is written into another vector." alt="" coords="671,54,875,95"/>
<area shape="rect" href="classcTraceEstimator.html#a02afa505a915c58380b99a62e4d56b30" title="For a given random input vector, computes one Monte&#45;Carlo sample to estimate trace using Lanczos quad..." alt="" coords="195,17,345,73"/>
<area shape="rect" href="classcTraceEstimator.html#a29144b4d62c71f0889002754384f57f4" title="Stochastic Lanczos quadrature method to estimate trace of a function of a linear operator...." alt="" coords="5,25,147,66"/>
<area shape="rect" href="c__golub__kahn__bidiagonalization_8cpp.html#a6125b021cd93b43ab4d9f20813487f85" title="Bi&#45;diagonalizes the positive&#45;definite matrix A using Golub&#45;Kahn&#45;Lanczos method." alt="" coords="393,57,623,84"/>
</map>
</div>

</div>
</div>
<a id="a492894cdc368a4f60b28aa15109cf9bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a492894cdc368a4f60b28aa15109cf9bc">&#9670;&nbsp;</a></span>copy_vector()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classcVectorOperations.html">cVectorOperations</a>&lt; DataType &gt;::copy_vector </td>
          <td>(</td>
          <td class="paramtype">const DataType *&#160;</td>
          <td class="paramname"><em>input_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a>&#160;</td>
          <td class="paramname"><em>vector_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType *&#160;</td>
          <td class="paramname"><em>output_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies a vector to a new vector. Result is written in-place. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_vector</td><td>A 1D array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_size</td><td>Length of vector array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output_vector</td><td>Output vector (written in place). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="c__vector__operations_8cpp_source.html#l00039">39</a> of file <a class="el" href="c__vector__operations_8cpp_source.html">c_vector_operations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">    #if (USE_CBLAS == 1)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// Using Openblas</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">int</span> incx = 1;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">int</span> incy = 1;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    cblas_interface::xcopy(vector_size, input_vector, incx, output_vector,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                           incy);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// Not using OpenBlas</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=0; i &lt; vector_size; ++i)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        output_vector[i] = input_vector[i];</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="c__lanczos__tridiagonalization_8cpp_source.html#l00117">c_lanczos_tridiagonalization()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_a492894cdc368a4f60b28aa15109cf9bc_icgraph.png" border="0" usemap="#aclasscVectorOperations_a492894cdc368a4f60b28aa15109cf9bc_icgraph" alt=""/></div>
<map name="aclasscVectorOperations_a492894cdc368a4f60b28aa15109cf9bc_icgraph" id="aclasscVectorOperations_a492894cdc368a4f60b28aa15109cf9bc_icgraph">
<area shape="rect" title="Copies a vector to a new vector. Result is written in&#45;place." alt="" coords="648,13,797,54"/>
<area shape="rect" href="c__lanczos__tridiagonalization_8cpp.html#a88831f1a1ba564b198f446a7c8a8d5ef" title="Tri&#45;diagonalizes matrix A to T using the start vector v. is the Lanczos degree, which will be the siz..." alt="" coords="393,20,600,47"/>
<area shape="rect" href="classcTraceEstimator.html#a02afa505a915c58380b99a62e4d56b30" title="For a given random input vector, computes one Monte&#45;Carlo sample to estimate trace using Lanczos quad..." alt="" coords="195,5,345,61"/>
<area shape="rect" href="classcTraceEstimator.html#a29144b4d62c71f0889002754384f57f4" title="Stochastic Lanczos quadrature method to estimate trace of a function of a linear operator...." alt="" coords="5,13,147,54"/>
</map>
</div>

</div>
</div>
<a id="abd0d2c941f9d3598f42026755cbc4709"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd0d2c941f9d3598f42026755cbc4709">&#9670;&nbsp;</a></span>euclidean_norm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataType <a class="el" href="classcVectorOperations.html">cVectorOperations</a>&lt; DataType &gt;::euclidean_norm </td>
          <td>(</td>
          <td class="paramtype">const DataType *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a>&#160;</td>
          <td class="paramname"><em>vector_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the Euclidean norm of a 1D array. </p>
<p>The reduction variable (here, <code>inner_prod</code> ) is of the type <code>long double</code>. This is becase when <code>DataType</code> is <code>float</code>, the summation loses the precision, especially when the vector size is large. It seems that using <code>long double</code> is slightly faster than using <code>double</code>. The advantage of using a type with larger bits for the reduction variable is only sensible if the compiler is optimized with <code>-O2</code> or <code>-O3</code> flags.</p>
<p>Using a larger bit type for the reduction variable is very important for this function. If <code>DataType</code> is <code>float</code>, without such consideration, the result of estimation of trace can be completely wrong, just becase of the wrong norm results. For large array sizes, even libraries such as openblas does not compute the dot product accurately.</p>
<p>The chunk computation of the dot product (as seen in the code with <code>chunk=5</code>) improves the preformance with gaining twice speedup. This result is not much dependet on <code>chunk</code>. For example, <code>chunk=10</code> also yields a similar result.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vector</td><td>A pointer to 1D array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_size</td><td>Length of the array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Euclidean norm </dd></dl>

<p class="definition">Definition at line <a class="el" href="c__vector__operations_8cpp_source.html#l00281">281</a> of file <a class="el" href="c__vector__operations_8cpp_source.html">c_vector_operations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">    #if (USE_CBLAS == 1)</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// Using OpenBlas</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">int</span> incx = 1;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    DataType norm = cblas_interface::xnrm2(vector_size, vector, incx);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> norm;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Compute norm squared</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> norm2 = 0.0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> chunk = 5;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size_chunked = vector_size - (vector_size % chunk);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=0; i &lt; vector_size_chunked; i += chunk)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        norm2 += vector[i] * vector[i] +</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                 vector[i+1] * vector[i+1] +</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                 vector[i+2] * vector[i+2] +</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                 vector[i+3] * vector[i+3] +</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                 vector[i+4] * vector[i+4];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=vector_size_chunked; i &lt; vector_size; ++i)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        norm2 += vector[i] * vector[i];</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// Norm</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    DataType norm = sqrt(<span class="keyword">static_cast&lt;</span>DataType<span class="keyword">&gt;</span>(norm2));</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> norm;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="c__lanczos__tridiagonalization_8cpp_source.html#l00117">c_lanczos_tridiagonalization()</a>, <a class="el" href="c__orthogonalization_8cpp_source.html#l00125">cOrthogonalization&lt; DataType &gt;::gram_schmidt_process()</a>, <a class="el" href="c__vector__operations_8cpp_source.html#l00389">cVectorOperations&lt; DataType &gt;::normalize_vector_and_copy()</a>, <a class="el" href="c__vector__operations_8cpp_source.html#l00338">cVectorOperations&lt; DataType &gt;::normalize_vector_in_place()</a>, and <a class="el" href="c__orthogonalization_8cpp_source.html#l00269">cOrthogonalization&lt; DataType &gt;::orthogonalize_vectors()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_abd0d2c941f9d3598f42026755cbc4709_icgraph.png" border="0" usemap="#aclasscVectorOperations_abd0d2c941f9d3598f42026755cbc4709_icgraph" alt=""/></div>
<map name="aclasscVectorOperations_abd0d2c941f9d3598f42026755cbc4709_icgraph" id="aclasscVectorOperations_abd0d2c941f9d3598f42026755cbc4709_icgraph">
<area shape="rect" title="Computes the Euclidean norm of a 1D array." alt="" coords="923,101,1072,143"/>
<area shape="rect" href="c__lanczos__tridiagonalization_8cpp.html#a88831f1a1ba564b198f446a7c8a8d5ef" title="Tri&#45;diagonalizes matrix A to T using the start vector v. is the Lanczos degree, which will be the siz..." alt="" coords="405,43,611,70"/>
<area shape="rect" href="classcOrthogonalization.html#a1b1bcbb636f1a1608ce7a22d4538b3b3" title="Modified Gram&#45;Schmidt orthogonalization process to orthogonalize the vector v against a subset of the..." alt="" coords="683,36,863,77"/>
<area shape="rect" href="classcVectorOperations.html#aeb0171f2644e3036907bbbddf47ce998" title="Normalizes a vector based on Euclidean 2&#45;norm. The result is written into another vector." alt="" coords="671,101,875,143"/>
<area shape="rect" href="classcVectorOperations.html#ab0991d74cadf3a3969f0723dbff55dc9" title="Normalizes a vector based on Euclidean 2&#45;norm. The result is written in&#45;place." alt="" coords="675,167,871,208"/>
<area shape="rect" href="classcOrthogonalization.html#a7b017e5520083a1cf3ac2ed27bb811d8" title="Orthogonalizes set of vectors mutually using modified Gram&#45;Schmidt process." alt="" coords="685,232,860,273"/>
<area shape="rect" href="classcTraceEstimator.html#a02afa505a915c58380b99a62e4d56b30" title="For a given random input vector, computes one Monte&#45;Carlo sample to estimate trace using Lanczos quad..." alt="" coords="195,61,345,117"/>
<area shape="rect" href="classcTraceEstimator.html#a29144b4d62c71f0889002754384f57f4" title="Stochastic Lanczos quadrature method to estimate trace of a function of a linear operator...." alt="" coords="5,68,147,109"/>
<area shape="rect" href="c__golub__kahn__bidiagonalization_8cpp.html#a6125b021cd93b43ab4d9f20813487f85" title="Bi&#45;diagonalizes the positive&#45;definite matrix A using Golub&#45;Kahn&#45;Lanczos method." alt="" coords="393,101,623,127"/>
</map>
</div>

</div>
</div>
<a id="ab8b945baba573b4479e8095ca87f8b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b945baba573b4479e8095ca87f8b3f">&#9670;&nbsp;</a></span>inner_product()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataType <a class="el" href="classcVectorOperations.html">cVectorOperations</a>&lt; DataType &gt;::inner_product </td>
          <td>(</td>
          <td class="paramtype">const DataType *&#160;</td>
          <td class="paramname"><em>vector1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DataType *&#160;</td>
          <td class="paramname"><em>vector2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a>&#160;</td>
          <td class="paramname"><em>vector_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes Euclidean inner product of two vectors. </p>
<p>The reduction variable (here, <code>inner_prod</code> ) is of the type <code>long double</code>. This is becase when <code>DataType</code> is <code>float</code>, the summation loses the precision, especially when the vector size is large. It seems that using <code>long double</code> is slightly faster than using <code>double</code>. The advantage of using a type with larger bits for the reduction variable is only sensible if the compiler is optimized with <code>-O2</code> or <code>-O3</code> flags.</p>
<p>Using a larger bit type for the reduction variable is very important for this function. If <code>DataType</code> is <code>float</code>, without such consideration, the result of estimation of trace can be completely wrong, just becase of the wrong inner product results. For large array sizes, even libraries such as openblas does not compute the dot product accurately.</p>
<p>The chunk computation of the dot product (as seen in the code with <code>chunk=5</code>) improves the preformance with gaining twice speedup. This result is not much dependet on <code>chunk</code>. For example, <code>chunk=10</code> also yields a similar result.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vector1</td><td>1D array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector2</td><td>1D array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_size</td><td>Length of array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Inner product of two vectors. </dd></dl>

<p class="definition">Definition at line <a class="el" href="c__vector__operations_8cpp_source.html#l00204">204</a> of file <a class="el" href="c__vector__operations_8cpp_source.html">c_vector_operations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">    #if (USE_CBLAS == 1)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// Using OpenBlas</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">int</span> incx = 1;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">int</span> incy = 1;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    DataType inner_prod = cblas_interface::xdot(vector_size, vector1, incx,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                vector2, incy);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> inner_prod;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// Not using OpenBlas</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> inner_prod = 0.0;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> chunk = 5;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> vector_size_chunked = vector_size - (vector_size % chunk);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=0; i &lt; vector_size_chunked; i += chunk)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        inner_prod += vector1[i] * vector2[i] +</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                      vector1[i+1] * vector2[i+1] +</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                      vector1[i+2] * vector2[i+2] +</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                      vector1[i+3] * vector2[i+3] +</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                      vector1[i+4] * vector2[i+4];</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=vector_size_chunked; i &lt; vector_size; ++i)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        inner_prod += vector1[i] * vector2[i];</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>DataType<span class="keyword">&gt;</span>(inner_prod);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="c__lanczos__tridiagonalization_8cpp_source.html#l00117">c_lanczos_tridiagonalization()</a>, <a class="el" href="c__orthogonalization_8cpp_source.html#l00125">cOrthogonalization&lt; DataType &gt;::gram_schmidt_process()</a>, and <a class="el" href="c__orthogonalization_8cpp_source.html#l00269">cOrthogonalization&lt; DataType &gt;::orthogonalize_vectors()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_ab8b945baba573b4479e8095ca87f8b3f_icgraph.png" border="0" usemap="#aclasscVectorOperations_ab8b945baba573b4479e8095ca87f8b3f_icgraph" alt=""/></div>
<map name="aclasscVectorOperations_ab8b945baba573b4479e8095ca87f8b3f_icgraph" id="aclasscVectorOperations_ab8b945baba573b4479e8095ca87f8b3f_icgraph">
<area shape="rect" title="Computes Euclidean inner product of two vectors." alt="" coords="899,49,1048,90"/>
<area shape="rect" href="c__lanczos__tridiagonalization_8cpp.html#a88831f1a1ba564b198f446a7c8a8d5ef" title="Tri&#45;diagonalizes matrix A to T using the start vector v. is the Lanczos degree, which will be the siz..." alt="" coords="405,5,611,32"/>
<area shape="rect" href="classcOrthogonalization.html#a1b1bcbb636f1a1608ce7a22d4538b3b3" title="Modified Gram&#45;Schmidt orthogonalization process to orthogonalize the vector v against a subset of the..." alt="" coords="671,49,851,90"/>
<area shape="rect" href="classcOrthogonalization.html#a7b017e5520083a1cf3ac2ed27bb811d8" title="Orthogonalizes set of vectors mutually using modified Gram&#45;Schmidt process." alt="" coords="673,114,848,155"/>
<area shape="rect" href="classcTraceEstimator.html#a02afa505a915c58380b99a62e4d56b30" title="For a given random input vector, computes one Monte&#45;Carlo sample to estimate trace using Lanczos quad..." alt="" coords="195,16,345,72"/>
<area shape="rect" href="classcTraceEstimator.html#a29144b4d62c71f0889002754384f57f4" title="Stochastic Lanczos quadrature method to estimate trace of a function of a linear operator...." alt="" coords="5,23,147,65"/>
<area shape="rect" href="c__golub__kahn__bidiagonalization_8cpp.html#a6125b021cd93b43ab4d9f20813487f85" title="Bi&#45;diagonalizes the positive&#45;definite matrix A using Golub&#45;Kahn&#45;Lanczos method." alt="" coords="393,56,623,83"/>
</map>
</div>

</div>
</div>
<a id="aeb0171f2644e3036907bbbddf47ce998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb0171f2644e3036907bbbddf47ce998">&#9670;&nbsp;</a></span>normalize_vector_and_copy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataType <a class="el" href="classcVectorOperations.html">cVectorOperations</a>&lt; DataType &gt;::normalize_vector_and_copy </td>
          <td>(</td>
          <td class="paramtype">const DataType *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a>&#160;</td>
          <td class="paramname"><em>vector_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType *&#160;</td>
          <td class="paramname"><em>output_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Normalizes a vector based on Euclidean 2-norm. The result is written into another vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vector</td><td>Input vector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_size</td><td>Length of the input vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output_vector</td><td>Output vector, which is the normalization of the input vector. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2-norm of the input vector </dd></dl>

<p class="definition">Definition at line <a class="el" href="c__vector__operations_8cpp_source.html#l00389">389</a> of file <a class="el" href="c__vector__operations_8cpp_source.html">c_vector_operations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">    #if (USE_CBLAS == 1)</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// Norm of vector</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    DataType norm = <a class="code" href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709">cVectorOperations&lt;DataType&gt;::euclidean_norm</a>(</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            vector, vector_size);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// Normalize to output</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    DataType scale = 1.0 / norm;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="classcVectorOperations.html#a6627fe95659faa224dca2af1dab1fab3">cVectorOperations&lt;DataType&gt;::copy_scaled_vector</a>(vector, vector_size, scale,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                                    output_vector);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">return</span> norm;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// Norm of vector</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    DataType norm = <a class="code" href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709">cVectorOperations&lt;DataType&gt;::euclidean_norm</a>(vector,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                                                vector_size);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// Normalize to output</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=0; i &lt; vector_size; ++i)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        output_vector[i] = vector[i] / norm;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span> norm;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="ttc" id="aclasscVectorOperations_html_a6627fe95659faa224dca2af1dab1fab3"><div class="ttname"><a href="classcVectorOperations.html#a6627fe95659faa224dca2af1dab1fab3">cVectorOperations::copy_scaled_vector</a></div><div class="ttdeci">static void copy_scaled_vector(const DataType *input_vector, const LongIndexType vector_size, const DataType scale, DataType *output_vector)</div><div class="ttdoc">Scales a vector and stores to a new vector.</div><div class="ttdef"><b>Definition:</b> <a href="c__vector__operations_8cpp_source.html#l00081">c_vector_operations.cpp:81</a></div></div>
<div class="ttc" id="aclasscVectorOperations_html_abd0d2c941f9d3598f42026755cbc4709"><div class="ttname"><a href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709">cVectorOperations::euclidean_norm</a></div><div class="ttdeci">static DataType euclidean_norm(const DataType *vector, const LongIndexType vector_size)</div><div class="ttdoc">Computes the Euclidean norm of a 1D array.</div><div class="ttdef"><b>Definition:</b> <a href="c__vector__operations_8cpp_source.html#l00281">c_vector_operations.cpp:281</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="c__vector__operations_8cpp_source.html#l00081">cVectorOperations&lt; DataType &gt;::copy_scaled_vector()</a>, and <a class="el" href="c__vector__operations_8cpp_source.html#l00281">cVectorOperations&lt; DataType &gt;::euclidean_norm()</a>.</p>

<p class="reference">Referenced by <a class="el" href="c__golub__kahn__bidiagonalization_8cpp_source.html#l00111">c_golub_kahn_bidiagonalization()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_aeb0171f2644e3036907bbbddf47ce998_cgraph.png" border="0" usemap="#aclasscVectorOperations_aeb0171f2644e3036907bbbddf47ce998_cgraph" alt=""/></div>
<map name="aclasscVectorOperations_aeb0171f2644e3036907bbbddf47ce998_cgraph" id="aclasscVectorOperations_aeb0171f2644e3036907bbbddf47ce998_cgraph">
<area shape="rect" title="Normalizes a vector based on Euclidean 2&#45;norm. The result is written into another vector." alt="" coords="5,39,209,80"/>
<area shape="rect" href="classcVectorOperations.html#a6627fe95659faa224dca2af1dab1fab3" title="Scales a vector and stores to a new vector." alt="" coords="257,5,408,47"/>
<area shape="rect" href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709" title="Computes the Euclidean norm of a 1D array." alt="" coords="258,71,407,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_aeb0171f2644e3036907bbbddf47ce998_icgraph.png" border="0" usemap="#aclasscVectorOperations_aeb0171f2644e3036907bbbddf47ce998_icgraph" alt=""/></div>
<map name="aclasscVectorOperations_aeb0171f2644e3036907bbbddf47ce998_icgraph" id="aclasscVectorOperations_aeb0171f2644e3036907bbbddf47ce998_icgraph">
<area shape="rect" title="Normalizes a vector based on Euclidean 2&#45;norm. The result is written into another vector." alt="" coords="671,13,875,54"/>
<area shape="rect" href="c__golub__kahn__bidiagonalization_8cpp.html#a6125b021cd93b43ab4d9f20813487f85" title="Bi&#45;diagonalizes the positive&#45;definite matrix A using Golub&#45;Kahn&#45;Lanczos method." alt="" coords="393,20,623,47"/>
<area shape="rect" href="classcTraceEstimator.html#a02afa505a915c58380b99a62e4d56b30" title="For a given random input vector, computes one Monte&#45;Carlo sample to estimate trace using Lanczos quad..." alt="" coords="195,5,345,61"/>
<area shape="rect" href="classcTraceEstimator.html#a29144b4d62c71f0889002754384f57f4" title="Stochastic Lanczos quadrature method to estimate trace of a function of a linear operator...." alt="" coords="5,13,147,54"/>
</map>
</div>

</div>
</div>
<a id="ab0991d74cadf3a3969f0723dbff55dc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0991d74cadf3a3969f0723dbff55dc9">&#9670;&nbsp;</a></span>normalize_vector_in_place()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataType <a class="el" href="classcVectorOperations.html">cVectorOperations</a>&lt; DataType &gt;::normalize_vector_in_place </td>
          <td>(</td>
          <td class="paramtype">DataType *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a>&#160;</td>
          <td class="paramname"><em>vector_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Normalizes a vector based on Euclidean 2-norm. The result is written in-place. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vector</td><td>Input vector to be normalized in-place. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_size</td><td>Length of the input vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2-Norm of the input vector (before normalization) </dd></dl>

<p class="definition">Definition at line <a class="el" href="c__vector__operations_8cpp_source.html#l00338">338</a> of file <a class="el" href="c__vector__operations_8cpp_source.html">c_vector_operations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">    #if (USE_CBLAS == 1)</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// Norm of vector</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    DataType norm = <a class="code" href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709">cVectorOperations&lt;DataType&gt;::euclidean_norm</a>(</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            vector, vector_size);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// Normalize in place</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    DataType scale = 1.0 / norm;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordtype">int</span> incx = 1;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    cblas_interface::xscal(vector_size, scale, vector, incx);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">return</span> norm;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// Norm of vector</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    DataType norm = <a class="code" href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709">cVectorOperations&lt;DataType&gt;::euclidean_norm</a>(vector,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                                                vector_size);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// Normalize in place</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=0; i &lt; vector_size; ++i)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        vector[i] /= norm;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">return</span> norm;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="c__vector__operations_8cpp_source.html#l00281">cVectorOperations&lt; DataType &gt;::euclidean_norm()</a>.</p>

<p class="reference">Referenced by <a class="el" href="c__golub__kahn__bidiagonalization_8cpp_source.html#l00111">c_golub_kahn_bidiagonalization()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_ab0991d74cadf3a3969f0723dbff55dc9_cgraph.png" border="0" usemap="#aclasscVectorOperations_ab0991d74cadf3a3969f0723dbff55dc9_cgraph" alt=""/></div>
<map name="aclasscVectorOperations_ab0991d74cadf3a3969f0723dbff55dc9_cgraph" id="aclasscVectorOperations_ab0991d74cadf3a3969f0723dbff55dc9_cgraph">
<area shape="rect" title="Normalizes a vector based on Euclidean 2&#45;norm. The result is written in&#45;place." alt="" coords="5,5,201,47"/>
<area shape="rect" href="classcVectorOperations.html#abd0d2c941f9d3598f42026755cbc4709" title="Computes the Euclidean norm of a 1D array." alt="" coords="249,5,399,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_ab0991d74cadf3a3969f0723dbff55dc9_icgraph.png" border="0" usemap="#aclasscVectorOperations_ab0991d74cadf3a3969f0723dbff55dc9_icgraph" alt=""/></div>
<map name="aclasscVectorOperations_ab0991d74cadf3a3969f0723dbff55dc9_icgraph" id="aclasscVectorOperations_ab0991d74cadf3a3969f0723dbff55dc9_icgraph">
<area shape="rect" title="Normalizes a vector based on Euclidean 2&#45;norm. The result is written in&#45;place." alt="" coords="671,13,867,54"/>
<area shape="rect" href="c__golub__kahn__bidiagonalization_8cpp.html#a6125b021cd93b43ab4d9f20813487f85" title="Bi&#45;diagonalizes the positive&#45;definite matrix A using Golub&#45;Kahn&#45;Lanczos method." alt="" coords="393,20,623,47"/>
<area shape="rect" href="classcTraceEstimator.html#a02afa505a915c58380b99a62e4d56b30" title="For a given random input vector, computes one Monte&#45;Carlo sample to estimate trace using Lanczos quad..." alt="" coords="195,5,345,61"/>
<area shape="rect" href="classcTraceEstimator.html#a29144b4d62c71f0889002754384f57f4" title="Stochastic Lanczos quadrature method to estimate trace of a function of a linear operator...." alt="" coords="5,13,147,54"/>
</map>
</div>

</div>
</div>
<a id="a9bd28bd08f5a6b096d99a4a2f7d23e90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bd28bd08f5a6b096d99a4a2f7d23e90">&#9670;&nbsp;</a></span>subtract_scaled_vector()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classcVectorOperations.html">cVectorOperations</a>&lt; DataType &gt;::subtract_scaled_vector </td>
          <td>(</td>
          <td class="paramtype">const DataType *&#160;</td>
          <td class="paramname"><em>input_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a>&#160;</td>
          <td class="paramname"><em>vector_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DataType&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType *&#160;</td>
          <td class="paramname"><em>output_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Subtracts the scaled input vector from the output vector. </p>
<p>Performs the following operation: </p><p class="formulaDsp">
\[ \boldsymbol{b} = \boldsymbol{b} - c \boldsymbol{a}, \]
</p>
<p> where</p><ul>
<li>\( \boldsymbol{a} \) is the input vector,</li>
<li>\( c \) is a scalar scale to the input vector, and</li>
<li>\( \boldsymbol{b} \) is the output vector that is written in-place.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_vector</td><td>A 1D array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vector_size</td><td>Length of vector array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scale</td><td>Scale coefficient to the input vector. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">output_vector</td><td>Output vector (written in place). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="c__vector__operations_8cpp_source.html#l00135">135</a> of file <a class="el" href="c__vector__operations_8cpp_source.html">c_vector_operations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">    #if (USE_CBLAS == 1)</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// Using OpenBlas</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">int</span> incx = 1;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span> incy = 1;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    DataType neg_scale = -scale;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    cblas_interface::xaxpy(vector_size, neg_scale, input_vector, incx,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                           output_vector, incy);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// Not using OpenBlas</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> (scale == 0.0)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a4918759cb64dcead17269b3613b27d25">LongIndexType</a> i=0; i &lt; vector_size; ++i)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        output_vector[i] -= scale * input_vector[i];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="c__affine__matrix__function_8cpp_source.html#l00136">cAffineMatrixFunction&lt; DataType &gt;::_add_scaled_vector()</a>, <a class="el" href="c__golub__kahn__bidiagonalization_8cpp_source.html#l00111">c_golub_kahn_bidiagonalization()</a>, <a class="el" href="c__lanczos__tridiagonalization_8cpp_source.html#l00117">c_lanczos_tridiagonalization()</a>, <a class="el" href="c__orthogonalization_8cpp_source.html#l00125">cOrthogonalization&lt; DataType &gt;::gram_schmidt_process()</a>, and <a class="el" href="c__orthogonalization_8cpp_source.html#l00269">cOrthogonalization&lt; DataType &gt;::orthogonalize_vectors()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcVectorOperations_a9bd28bd08f5a6b096d99a4a2f7d23e90_icgraph.png" border="0" usemap="#aclasscVectorOperations_a9bd28bd08f5a6b096d99a4a2f7d23e90_icgraph" alt=""/></div>
<map name="aclasscVectorOperations_a9bd28bd08f5a6b096d99a4a2f7d23e90_icgraph" id="aclasscVectorOperations_a9bd28bd08f5a6b096d99a4a2f7d23e90_icgraph">
<area shape="rect" title="Subtracts the scaled input vector from the output vector." alt="" coords="899,123,1071,164"/>
<area shape="rect" href="classcAffineMatrixFunction.html#a144b790e6cf7ef04d2b140a8031929a4" title="Performs the operation , where &#160;is an input vector scaled by &#160;and &#160;it the output vector." alt="" coords="679,5,843,47"/>
<area shape="rect" href="c__golub__kahn__bidiagonalization_8cpp.html#a6125b021cd93b43ab4d9f20813487f85" title="Bi&#45;diagonalizes the positive&#45;definite matrix A using Golub&#45;Kahn&#45;Lanczos method." alt="" coords="393,105,623,131"/>
<area shape="rect" href="c__lanczos__tridiagonalization_8cpp.html#a88831f1a1ba564b198f446a7c8a8d5ef" title="Tri&#45;diagonalizes matrix A to T using the start vector v. is the Lanczos degree, which will be the siz..." alt="" coords="405,155,611,182"/>
<area shape="rect" href="classcOrthogonalization.html#a1b1bcbb636f1a1608ce7a22d4538b3b3" title="Modified Gram&#45;Schmidt orthogonalization process to orthogonalize the vector v against a subset of the..." alt="" coords="671,123,851,164"/>
<area shape="rect" href="classcOrthogonalization.html#a7b017e5520083a1cf3ac2ed27bb811d8" title="Orthogonalizes set of vectors mutually using modified Gram&#45;Schmidt process." alt="" coords="673,240,848,281"/>
<area shape="rect" href="classcTraceEstimator.html#a02afa505a915c58380b99a62e4d56b30" title="For a given random input vector, computes one Monte&#45;Carlo sample to estimate trace using Lanczos quad..." alt="" coords="195,115,345,171"/>
<area shape="rect" href="classcTraceEstimator.html#a29144b4d62c71f0889002754384f57f4" title="Stochastic Lanczos quadrature method to estimate trace of a function of a linear operator...." alt="" coords="5,123,147,164"/>
</map>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/imate/imate/imate/_c_basic_algebra/<a class="el" href="c__vector__operations_8h_source.html">c_vector_operations.h</a></li>
<li>/home/runner/work/imate/imate/imate/_c_basic_algebra/<a class="el" href="c__vector__operations_8cpp_source.html">c_vector_operations.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classcVectorOperations.html">cVectorOperations</a></li>
    <li class="footer">Generated on Mon Dec 4 2023 01:02:26 for imate by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>

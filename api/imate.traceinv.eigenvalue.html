


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>imate.traceinv(method=’eigenvalue’) &#8212; imate Manual</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom-pydata.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/toggleprompt.js"></script>
    <script src="../_static/js/custom-pydata.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/logo-imate.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="imate.traceinv(method=’cholesky’)" href="imate.traceinv.cholesky.html" />
    <link rel="prev" title="imate.traceinv" href="../generated/imate.traceinv.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>
    
    <script type="text/javascript" src="../_static/js/custom-pydata.js"></script>
    
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="auto">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img src="../_static/images/icons/logo-imate-light.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/images/icons/logo-imate-dark.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/install.html">
  1. Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/docker.html">
  2. Docker
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/gpu.html">
  3. GPU
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../cite.html">
  Publications
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ameli/imate" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://pypi.org/project/imate/" rel="noopener" target="_blank" title="PyPI"><span><i class="fab fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://anaconda.org/s-ameli/imate" rel="noopener" target="_blank" title="Anaconda Cloud"><span><i class="fa fa-circle-notch"></i></span>
            <label class="sr-only">Anaconda Cloud</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://hub.docker.com/repository/docker/sameli/imate" rel="noopener" target="_blank" title="Docker Hub"><span><i class="fab fa-docker"></i></span>
            <label class="sr-only">Docker Hub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://mybinder.org/v2/gh/ameli/imate/HEAD?filepath=notebooks%2FInterpolateTraceOfInverse.ipynb" rel="noopener" target="_blank" title="Lanuch Jupyter on Binder"><span><i class="fa fa-chart-line"></i></span>
            <label class="sr-only">Lanuch Jupyter on Binder</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  logdet
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.logdet.html">
   imate.logdet
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.logdet.eigenvalue.html">
   imate.logdet(method=’eigenvalue’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.logdet.cholesky.html">
   imate.logdet(method=’cholesky’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.logdet.slq.html">
   imate.logdet(method=’slq’)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  traceinv
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.traceinv.html">
   imate.traceinv
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   imate.traceinv(method=’eigenvalue’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.traceinv.cholesky.html">
   imate.traceinv(method=’cholesky’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.traceinv.hutchinson.html">
   imate.traceinv(method=’hutchinson’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.traceinv.slq.html">
   imate.traceinv(method=’slq’)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  trace
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.trace.html">
   imate.trace
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="imate.trace.exact.html">
   imate.trace(method=’exact’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.trace.eigenvalue.html">
   imate.trace(method=’eigenvalue’)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imate.trace.slq.html">
   imate.trace(method=’slq’)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Schatten Norm
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.schatten.html">
   imate.schatten
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Interpolators
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.InterpolateLogdet.html">
   imate.InterpolateLogdet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.InterpolateTrace.html">
   imate.InterpolateTrace
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.InterpolateSchatten.html">
   imate.InterpolateSchatten
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Operators
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.Matrix.html">
   imate.Matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.AffineMatrixFunction.html">
   imate.AffineMatrixFunction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Sample Matrices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.correlation_matrix.html">
   imate.correlation_matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.toeplitz.html">
   imate.toeplitz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.sample_matrices.toeplitz_logdet.html">
   imate.sample_matrices.toeplitz_logdet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.sample_matrices.toeplitz_trace.html">
   imate.sample_matrices.toeplitz_trace
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.sample_matrices.toeplitz_traceinv.html">
   imate.sample_matrices.toeplitz_traceinv
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.sample_matrices.toeplitz_schatten.html">
   imate.sample_matrices.toeplitz_schatten
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Device Inquiry
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.Timer.html">
   imate.Timer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.Memory.html">
   imate.Memory
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.info.html">
   imate.info
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.device.get_processor_name.html">
   imate.device.get_processor_name
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.device.get_gpu_name.html">
   imate.device.get_gpu_name
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.device.get_num_cpu_threads.html">
   imate.device.get_num_cpu_threads
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.device.get_num_gpu_devices.html">
   imate.device.get_num_gpu_devices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.device.locate_cuda.html">
   imate.device.locate_cuda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/imate.device.restrict_to_single_processor.html">
   imate.device.restrict_to_single_processor
  </a>
 </li>
</ul>

    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      

<nav id="bd-toc-nav">
    
</nav>
    </div>
    
    <div class="toc-item">
      

<div class="tocsection editthispage">
    <a href="https://github.com/https://github.com/ameli/imate/edit/main/docs/source/api/imate.traceinv.eigenvalue.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="imate-traceinv-method-eigenvalue">
<span id="imate-traceinv-eigenvalue"></span><h1>imate.traceinv(method=’eigenvalue’)<a class="headerlink" href="#imate-traceinv-method-eigenvalue" title="Permalink to this heading">#</a></h1>
<dl class="custom-domain function">
<dt class="sig sig-object custom-domain">
<span class="sig-prename descclassname"><span class="pre">imate.</span></span><span class="sig-name descname"><span class="pre">traceinv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eigenvalue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_zero_eig_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Log-determinant of non-singular matrix using eigenvalue method.</p>
<blockquote>
<div><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>This page describes only the <cite>eigenvalue</cite> method. For other
methods, see <a class="reference internal" href="../generated/imate.traceinv.html#imate.traceinv" title="imate.traceinv"><code class="xref py py-func docutils literal notranslate"><span class="pre">imate.traceinv()</span></code></a>.</p>
</div>
</div></blockquote>
<p>Given the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and the real exponent <span class="math notranslate nohighlight">\(p\)</span>, the
following is computed:</p>
<div class="math notranslate nohighlight">
\[\mathrm{logdet} \left(\mathbf{A}^p \right) = p \log_e \vert
\det (\mathbf{A}) \vert.\]</div>
<p>If <code class="docutils literal notranslate"><span class="pre">gram</span></code> is <cite>True</cite>, then <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> in the above is replaced by
the Gramian matrix <span class="math notranslate nohighlight">\(\mathbf{A}^{\intercal} \mathbf{A}\)</span>, and the
following is instead computed:</p>
<div class="math notranslate nohighlight">
\[\mathrm{logdet} \left((\mathbf{A}^{\intercal}\mathbf{A})^p
\right) = 2p \log_e \vert \det (\mathbf{A}) \vert.\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>A</strong><span class="classifier">numpy.ndarray, scipy.sparse</span></dt><dd><p>A non-singular sparse or dense matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the &lt;F3&gt;eigenvalue method, the matrix cannot be a type of
<a class="reference internal" href="../generated/imate.Matrix.html#imate.Matrix" title="imate.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> or <a class="reference internal" href="../generated/imate.AffineMatrixFunction.html#imate.AffineMatrixFunction" title="imate.AffineMatrixFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">imate.AffineMatrixFunction</span></code></a> classes.</p>
</div>
</dd>
<dt><strong>gram</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <cite>True</cite>, the log-determinant of the Gramian matrix,
<span class="math notranslate nohighlight">\((\mathbf{A}^{\intercal}\mathbf{A})^p\)</span>, is computed. The
Gramian matrix itself is not directly computed. If <cite>False</cite>, the
log-determinant of <span class="math notranslate nohighlight">\(\mathbf{A}^p\)</span> is computed.</p>
</dd>
<dt><strong>p</strong><span class="classifier">float, default=1.0</span></dt><dd><p>The exponent <span class="math notranslate nohighlight">\(p\)</span> in <span class="math notranslate nohighlight">\(\mathbf{A}^p\)</span>.</p>
</dd>
<dt><strong>return_info</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <cite>True</cite>, this function also returns a dictionary containing
information about the inner computation, such as process time,
algorithm settings, etc.</p>
</dd>
<dt><strong>eigenvalues</strong><span class="classifier">array_like [<cite>float</cite>], default=None</span></dt><dd><p>The array of all eigenvalues of <cite>A</cite>, if available. The size of this
array must be the same as the size of <cite>A</cite>. If <cite>None</cite>, the eigenvalues
of <cite>A</cite> are computed.</p>
</dd>
<dt><strong>assume_matrix</strong><span class="classifier">str {‘gen’, ‘sym’}, default: ‘gen’</span></dt><dd><p>Type of matrix. <cite>gen</cite> assumes generic matrix, while <cite>sym</cite> assumes
<cite>A</cite> is symmetric.</p>
</dd>
<dt><strong>non_zero_eig_fraction</strong><span class="classifier">float, default=0.9</span></dt><dd><p>A fraction (between <cite>0</cite> and <cite>1</cite>) of eigenvalues assumed to be non-zero.
For large matrices, it is not possible to compute all eigenvalues, and
only the largest eigenvalues can be computed and the rest are assumed
to be negligible. By setting this parameter, a fraction of
non-negligible eigenvalues is determined.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>logdet</strong><span class="classifier">float or numpy.array</span></dt><dd><p>Log-determinant of <cite>A</cite>.</p>
</dd>
<dt><strong>info</strong><span class="classifier">dict</span></dt><dd><p>(Only if <code class="docutils literal notranslate"><span class="pre">return_info</span></code> is <cite>True</cite>) A dictionary of information with
the following keys.</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">matrix</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">data_type</span></code>: <cite>str</cite>, {<cite>float32</cite>, <cite>float64</cite>, <cite>float128</cite>}, type of
the matrix data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gram</span></code>: <cite>bool</cite>, whether the matrix <cite>A</cite> or its Gramian is
considered.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exponent</span></code>: <cite>float</cite>, the exponent <cite>p</cite> in <span class="math notranslate nohighlight">\(\mathbf{A}^p\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assume_matrix</span></code>: <cite>str</cite>, {<cite>gen</cite>, <cite>sym</cite>}, determines whether
matrix is generic or symmetric.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code>: <cite>int</cite>, the size of matrix <cite>A</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sparse</span></code>: <cite>bool</cite>, whether the matrix <cite>A</cite> is sparse or dense.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nnz</span></code>: <cite>int</cite>, if <cite>A</cite> is sparse, the number of non-zero elements
of <cite>A</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">density</span></code>: <cite>float</cite>, if <cite>A</cite> is sparse, the density of <cite>A</cite>, which
is the <cite>nnz</cite> divided by size squared.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_inquiries</span></code>: <cite>int</cite>, for the <cite>eigenvalue</cite> method, this is
always <cite>1</cite>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">device</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">num_cpu_threads</span></code>: <cite>int</cite>, number of CPU threads used in shared
memory parallel processing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_gpu_devices</span></code>: <cite>int</cite>, for the <cite>eigenvalue</cite> method, this is
always <cite>0</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_gpu_multiprocessors</span></code>: <cite>int</cite>, for the <cite>eigenvalue</cite> method,
this is always <cite>0</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_gpu_threads_per_multiprocessor</span></code>: <cite>int</cite>, for <cite>eigenvalue</cite>
method, this is always <cite>0</cite>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">time</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tot_wall_time</span></code>: <cite>float</cite>, total elapsed time of computation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alg_wall_time</span></code>: <cite>float</cite>, elapsed time of computation during
only the algorithm execution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cpu_proc_time</span></code>: <cite>float</cite>, the CPU processing time of
computation.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">solver</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">version</span></code>: <cite>str</cite>, version of imate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: ‘eigenvalue’</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../generated/imate.trace.html#imate.trace" title="imate.trace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">imate.trace</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="../generated/imate.traceinv.html#imate.traceinv" title="imate.traceinv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">imate.traceinv</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="../generated/imate.schatten.html#imate.schatten" title="imate.schatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">imate.schatten</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The eigenvalue method uses spectral decomposition. This method is suitable
for small matrices (<span class="math notranslate nohighlight">\(n &lt; 2^{12}\)</span>). The solution is exact and can be
used as a benchmark to test randomized methods of computing
log-determinant.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is not recommended to use this method for sparse matrices, as not
all eigenvalues of sparse matrices can be computed.</p>
</div>
<p class="rubric">Examples</p>
<p><strong>Dense matrix:</strong></p>
<p>Compute the log-determinant of a sample sparse Toeplitz matrix created
by <a class="reference internal" href="../generated/imate.toeplitz.html#imate.toeplitz" title="imate.toeplitz"><code class="xref py py-func docutils literal notranslate"><span class="pre">imate.toeplitz()</span></code></a> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Import packages</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">imate</span> <span class="kn">import</span> <span class="n">toeplitz</span><span class="p">,</span> <span class="n">logdet</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate a sample symmetric matrix (a toeplitz matrix)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">toeplitz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">gram</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert the sparse matrix to a dense matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute log-determinant with Cholesky method (default method)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logdet</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;eigenvalue&#39;</span><span class="p">,</span> <span class="n">assume_matrix</span><span class="o">=</span><span class="s1">&#39;sym&#39;</span><span class="p">)</span>
<span class="go">138.62943611198907</span>
</pre></div>
</div>
<p>Alternatively, compute the eigenvalues of <cite>A</cite> in advance, and pass it to
this function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute eigenvalues of symmetric matrix A.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eigh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">eigvals_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Pass the eigenvalues to logdet function</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">logdet</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;eigenvalue&#39;</span><span class="p">,</span> <span class="n">eigenvalues</span><span class="o">=</span><span class="n">eigenvalues</span><span class="p">)</span>
</span><span class="go">138.62943611198907</span>
</pre></div>
</div>
<p>Print information about the inner computation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ld</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">logdet</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;eigenvalue&#39;</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ld</span><span class="p">)</span>
<span class="go">138.6294361119891</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print dictionary neatly using pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
<span class="go">{</span>
<span class="go">    &#39;matrix&#39;: {</span>
<span class="go">        &#39;assume_matrix&#39;: &#39;gen&#39;,</span>
<span class="go">        &#39;data_type&#39;: b&#39;float64&#39;,</span>
<span class="go">        &#39;density&#39;: 1.0,</span>
<span class="go">        &#39;exponent&#39;: 1.0,</span>
<span class="go">        &#39;gram&#39;: False,</span>
<span class="go">        &#39;nnz&#39;: 10000,</span>
<span class="go">        &#39;num_inquiries&#39;: 1,</span>
<span class="go">        &#39;size&#39;: 100,</span>
<span class="go">        &#39;sparse&#39;: False</span>
<span class="go">    },</span>
<span class="go">    &#39;device&#39;: {</span>
<span class="go">        &#39;num_cpu_threads&#39;: 8,</span>
<span class="go">        &#39;num_gpu_devices&#39;: 0,</span>
<span class="go">        &#39;num_gpu_multiprocessors&#39;: 0,</span>
<span class="go">        &#39;num_gpu_threads_per_multiprocessor&#39;: 0</span>
<span class="go">    },</span>
<span class="go">    &#39;solver&#39;: {</span>
<span class="go">        &#39;method&#39;: &#39;eigenvalue&#39;,</span>
<span class="go">        &#39;version&#39;: &#39;0.13.0&#39;</span>
<span class="go">    },</span>
<span class="go">    &#39;time&#39;: {</span>
<span class="go">        &#39;alg_wall_time&#39;: 0.007327683997573331,</span>
<span class="go">        &#39;cpu_proc_time&#39;: 0.014451992999999774,</span>
<span class="go">        &#39;tot_wall_time&#39;: 0.007327683997573331</span>
<span class="go">    }</span>
<span class="go">}</span>
</pre></div>
</div>
<p><strong>Sparse matrix:</strong></p>
<p>Using a large matrix and ignoring 10% of its eigenvalues:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate a symmetric sparse matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">toeplitz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">gram</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assume only 80% of eigenvalues of A are non-zero</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logdet</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;eigenvalue&#39;</span><span class="p">,</span> <span class="n">assume_matrix</span><span class="o">=</span><span class="s1">&#39;sym&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">non_zero_eig_fraction</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="go">2451.2640192906174</span>
</pre></div>
</div>
<p>The above result is only an approximation since not all eigenvalues of <cite>A</cite>
are taken into account. To compare with the exact solution, use
<a class="reference internal" href="../generated/imate.sample_matrices.toeplitz_logdet.html#imate.sample_matrices.toeplitz_logdet" title="imate.sample_matrices.toeplitz_logdet"><code class="xref py py-func docutils literal notranslate"><span class="pre">imate.sample_matrices.toeplitz_logdet()</span></code></a> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">imate.sample_matrices</span> <span class="kn">import</span> <span class="n">toeplitz_logdet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toeplitz_logdet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">gram</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">2772.588722239781</span>
</pre></div>
</div>
<p>There is a significant difference between the approximation with&lt;F3&gt; 90% of
eigenvalues and the actual solution. Because of this, it is not recommended
to use the eigenvalue method to compute the log-determinant.</p>
</dd></dl>

</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="../generated/imate.traceinv.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">imate.traceinv</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="imate.traceinv.cholesky.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">imate.traceinv(method=’cholesky’)</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, Siavash Ameli.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; TraceInv  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/toggleprompt.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Compute Log-Determinant (TraceInv.ComputeLogDeterminant)" href="ComputeLogDeterminant.html" />
    <link rel="prev" title="Quick Start" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> TraceInv
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-1">Example 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-2">Example 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-3">Example 3</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Sub-packages User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ComputeLogDeterminant.html">Compute Log Determinant</a></li>
<li class="toctree-l1"><a class="reference internal" href="ComputeTraceOfInverse.html">Compute Trace of Inverse</a></li>
<li class="toctree-l1"><a class="reference internal" href="InterpolateTraceOfInverse.html">Interpolate Trace of Inverse</a></li>
<li class="toctree-l1"><a class="reference internal" href="GenerateMatrix.html">Generate Matrix</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_modules/modules.html">Package API</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Running Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TraceInv</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<span id="allexamples"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>Three examples are provided in <a class="reference external" href="https://github.com/ameli/TraceInv/blob/master/examples"><code class="docutils literal notranslate"><span class="pre">/examples</span></code></a>, which aim to reproduce the figures presented in <a class="reference internal" href="references.html#ameli-2020" id="id1"><span>[Ameli-2020]</span></a>. Namely, in that reference,</p>
<ul class="simple">
<li><p><strong>Example 1:</strong> Script <a class="reference external" href="https://github.com/ameli/TraceInv/blob/master/examples/Plot_TraceInv_FullRank.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_TraceInv_FullRank.py</span></code></a> reproduces Figure 2.</p></li>
<li><p><strong>Example 2:</strong> Script <a class="reference external" href="https://github.com/ameli/TraceInv/blob/master/examples/Plot_TraceInv_IllConditioned.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_TraceInv_IllConditioned.py</span></code></a> reproduces Figure 3.</p></li>
<li><p><strong>Example 3:</strong> Script <a class="reference external" href="https://github.com/ameli/TraceInv/blob/master/examples/Plot_GeneralizedCrossValidation.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_GeneralizedCorssValidation.py</span></code></a> reproduces Figure 4 and generates the results of Table 2.</p></li>
</ul>
<dl>
<dt>Before running examples:</dt><dd><p>To run the examples, you may not need to install the <code class="docutils literal notranslate"><span class="pre">TraceInv</span></code> package. Rather, download the source code and install requirements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ameli</span><span class="o">/</span><span class="n">TraceInv</span><span class="o">.</span><span class="n">git</span>

<span class="c1"># Install prerequisite packages</span>
<span class="n">cd</span> <span class="n">TraceInv</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Then, run either of the examples as described below.</p>
</dd>
</dl>
<div class="section" id="example-1">
<span id="example-one"></span><h2>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h2>
<p>The script <a class="reference external" href="https://github.com/ameli/TraceInv/blob/master/examples/Plot_TraceInv_FullRank.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_TraceInv_FullRank.py</span></code></a> plots the interpolation of the function</p>
<div class="math notranslate nohighlight">
\[\tau(t) = \mathrm{trace} \left( (\mathbf{A} + t \mathbf{I})^{-1} \right)\]</div>
<p>using <strong>Root Monomial basis Function</strong> method. Here, <span class="math notranslate nohighlight">\(\mathbf{I}\)</span> is the identity matrix, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a dense full-rank correlation matrix of the size <span class="math notranslate nohighlight">\(50^2 \times 50^2\)</span>, and <span class="math notranslate nohighlight">\(t \in [10^{-4},10^3]\)</span>.</p>
<p>Run this example by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">Plot_TraceInv_FullRank</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The script generates the figure below (see Figure 2 of <a class="reference internal" href="references.html#ameli-2020" id="id2"><span>[Ameli-2020]</span></a>).</p>
<img alt="_images/Example1.svg" class="align-center" src="_images/Example1.svg" /><p>The plot on the left shows the interpolation of <span class="math notranslate nohighlight">\(\tau(t)\)</span>. Each colored curve is obtained using different number of interpolant points <span class="math notranslate nohighlight">\(p\)</span>. The plot on the right represents the relative error  of interpolation compared to the accurate computation when no interpolation is applied. Clearly, employing more interpolant points (such as the red curve with <span class="math notranslate nohighlight">\(p = 9\)</span> interpolant points) yield smaller interpolation error.</p>
</div>
<div class="section" id="example-2">
<span id="example-two"></span><h2>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h2>
<p>The script <a class="reference external" href="https://github.com/ameli/TraceInv/blob/master/examples/Plot_TraceInv_IllConditioned.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_TraceInv_IllConditioned.py</span></code></a> plots the interpolation of the function <span class="math notranslate nohighlight">\(\tau(t)\)</span> as defined in <a class="reference internal" href="#example-1"><span class="std std-ref">Example 1</span></a>, however, here, the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[\mathbf{A} = \mathbf{X}^{\intercal} \mathbf{X} + s \mathbf{I}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is an ill-conditioned matrix of the size <span class="math notranslate nohighlight">\(1000 \times 500\)</span>, and the fixed shift parameter <span class="math notranslate nohighlight">\(s=10^{-3}\)</span> is applied to improve the condition number of the matrix to become invertible.</p>
<p>The interpolation is performed using <strong>Rational Polynomial Function</strong> method for <span class="math notranslate nohighlight">\(t \in [-10^{-3},10^{3}]\)</span>.</p>
<p>Run this example by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">Plot_TraceInv_IllConditioned</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The script generates the figure below (see also  Figure 3 of <a class="reference internal" href="references.html#ameli-2020" id="id3"><span>[Ameli-2020]</span></a>).</p>
<img alt="_images/Example2.svg" class="align-center" src="_images/Example2.svg" /></div>
<div class="section" id="example-3">
<span id="example-three"></span><h2>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h2>
<p>The script <a class="reference external" href="https://github.com/ameli/TraceInv/blob/master/examples/Plot_GeneralizedCrossValidation.py"><code class="docutils literal notranslate"><span class="pre">/examples/Plot_GeneralizedCorssValidation.py</span></code></a> plots the <a class="reference external" href="https://www.jstor.org/stable/1390722?seq=1">Generalized Cross-validation</a> function</p>
<div class="math notranslate nohighlight">
\[V(\theta) = \frac{\frac{1}{n} \| \mathbf{I} - \mathbf{X} (\mathbf{X}^{\intercal} \mathbf{X} + n \theta \mathbf{I})^{-1} \mathbf{X}^{\intercal} \boldsymbol{z} \|_2^2}{\left( \frac{1}{n} \mathrm{trace}\left( (\mathbf{I} - \mathbf{X}(\mathbf{X}^{\intercal} \mathbf{X} + n \theta \mathbf{I})^{-1})\mathbf{X}^{\intercal} \right) \right)^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is the same matrix as <a class="reference internal" href="#example-2"><span class="std std-ref">Example 2</span></a> and the term involving the trace of inverse in the denominator is interpolated as presented in <a class="reference internal" href="#example-2"><span class="std std-ref">Example 2</span></a>.</p>
<p>Run this example by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">Plot_GeneralizedCrossValidation</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The script generates the figure below and prints the processing times of the computations. See more details in Figure 3 and results of Table 2 of <a class="reference internal" href="references.html#ameli-2020" id="id4"><span>[Ameli-2020]</span></a>.</p>
<a class="reference internal image-reference" href="_images/GeneralizedCrossValidation.svg"><img alt="_images/GeneralizedCrossValidation.svg" class="align-center" src="_images/GeneralizedCrossValidation.svg" width="550" /></a>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ComputeLogDeterminant.html" class="btn btn-neutral float-right" title="Compute Log-Determinant (TraceInv.ComputeLogDeterminant)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Siavash Ameli

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>